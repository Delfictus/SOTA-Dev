â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     PRISM4D NHS RT-FULL - BATCH MODE (from manifest)          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[2026-02-11T19:20:00Z INFO  nhs_rt_full] Loading manifest: e2e_validation_test/kras_ensemble_40rep.json
[2026-02-11T19:20:00Z INFO  nhs_rt_full] Manifest loaded: 1 structures in 1 batches
[2026-02-11T19:20:00Z INFO  nhs_rt_full]   Collecting batch 0: 1 structures, 40 replicas (tier: large)
[2026-02-11T19:20:00Z INFO  nhs_rt_full] SIZE-TIER SEQUENTIAL BATCHING: 1 structures across 1 tiers
[2026-02-11T19:20:00Z INFO  nhs_rt_full]   Tier medium (5K-20K atoms): 1 structures (10403-10403 atoms), 40 entries with 40 replicas
[2026-02-11T19:20:00Z INFO  nhs_rt_full] Creating ONE CudaContext (device 0)...
[2026-02-11T19:20:00Z INFO  nhs_rt_full] ONE CudaContext. ZERO threads. 1 tiers sequentially.
[2026-02-11T19:20:00Z INFO  nhs_rt_full] â•â•â• Tier 1/1: medium (5K-20K atoms) (1 structures, max 10403 atoms) â•â•â•
[2026-02-11T19:20:00Z INFO  nhs_rt_full]     Creating AmberSimdBatch: 1 structures Ã— 40 replicas = 40 total entries, max 10403 atoms
[2026-02-11T19:20:00Z INFO  prism_gpu::amber_simd_batch] AmberSimdBatch initialized: max 40 structures Ã— 10403 atoms
[2026-02-11T19:20:00Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/6epm_complex.topology.json
[2026-02-11T19:20:00Z INFO  prism_nhs::input] Loaded topology: 10403 atoms, 631 residues, 2 chains
[2026-02-11T19:20:00Z INFO  nhs_rt_full]       Loaded: 6epm_kras_sos1 (10403 atoms, 1245 aromatics) â†’ 40 replicas starting at ID 0
[2026-02-11T19:20:00Z INFO  nhs_rt_full]     Finalizing batch for GPU upload...
[2026-02-11T19:20:00Z INFO  prism_gpu::h_constraints] ğŸ”— HConstraints: 133080 clusters (74120 single, 42680 CH2/NH2, 16280 CH3/NH3)
[2026-02-11T19:20:00Z INFO  prism_gpu::amber_simd_batch] H-constraints: 133080 clusters (208320 total constraints, DOF adjusted)
[2026-02-11T19:20:00Z INFO  prism_gpu::amber_simd_batch] Initializing FP16 parameter buffers...
[2026-02-11T19:20:00Z INFO  prism_gpu::amber_simd_batch]   FP16 buffers: 416120 atoms (812 KB saved)
[2026-02-11T19:20:00Z INFO  prism_gpu::amber_simd_batch] Initializing Verlet neighbor list...
[2026-02-11T19:20:00Z INFO  prism_gpu::amber_simd_batch]   Verlet list: 416120 atoms, skin=2.0Ã…, rebuild threshold=1.0Ã…
[2026-02-11T19:20:00Z INFO  prism_gpu::amber_simd_batch] Initializing Tensor Core force calculator...
[2026-02-11T19:20:00Z INFO  prism_gpu::amber_simd_batch]   Tensor Cores: enabled (WMMA 16Ã—16 tiles)
[2026-02-11T19:20:00Z INFO  prism_gpu::amber_simd_batch] Initializing async MD pipeline...
[2026-02-11T19:20:00Z INFO  prism_gpu::amber_simd_batch]   Async pipeline: enabled (bonded/non-bonded overlap)
[2026-02-11T19:20:00Z INFO  prism_gpu::amber_simd_batch] SOTA optimizations enabled:
[2026-02-11T19:20:00Z INFO  prism_gpu::amber_simd_batch]   - Verlet list: YES
[2026-02-11T19:20:00Z INFO  prism_gpu::amber_simd_batch]   - Tensor Cores: YES
[2026-02-11T19:20:00Z INFO  prism_gpu::amber_simd_batch]   - FP16 params: YES
[2026-02-11T19:20:00Z INFO  prism_gpu::amber_simd_batch]   - Async pipeline: YES
[2026-02-11T19:20:00Z INFO  prism_gpu::amber_simd_batch]   - Batched forces: YES
[2026-02-11T19:20:00Z INFO  prism_gpu::amber_simd_batch] Batch finalized: 40 structures, 416120 atoms
[2026-02-11T19:20:00Z INFO  nhs_rt_full]       âœ“ Batch ready: 40 total entries (1 structures Ã— 40 replicas) on GPU
[2026-02-11T19:20:00Z INFO  nhs_rt_full]     Running 100000 steps per replica (batch executes in lockstep)...
[2026-02-11T19:20:00Z INFO  nhs_rt_full]       Protocol phases: cold=50000, ramp=25000, warm=25000
[2026-02-11T19:20:00Z INFO  nhs_rt_full]     [1/3] Cold hold at 100K (50000 steps)...
[2026-02-11T19:20:00Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 40 structures, 416120 atoms, 500 steps
[2026-02-11T19:20:00Z INFO  prism_gpu::amber_simd_batch] Using SOTA path with Verlet neighbor lists
[2026-02-11T19:21:23Z INFO  prism_gpu::amber_simd_batch] SOTA MD complete: 500 steps, 3 Verlet rebuilds (avg 166.7 steps/rebuild)
[2026-02-11T19:21:23Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD complete: 500 steps
[2026-02-11T19:21:23Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 40 structures, 416120 atoms, 500 steps
[2026-02-11T19:21:23Z INFO  prism_gpu::amber_simd_batch] Using SOTA path with Verlet neighbor lists
[2026-02-11T19:22:46Z INFO  prism_gpu::amber_simd_batch] SOTA MD complete: 500 steps, 3 Verlet rebuilds (avg 333.3 steps/rebuild)
[2026-02-11T19:22:46Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD complete: 500 steps
[2026-02-11T19:22:46Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 40 structures, 416120 atoms, 500 steps
[2026-02-11T19:22:46Z INFO  prism_gpu::amber_simd_batch] Using SOTA path with Verlet neighbor lists
[2026-02-11T19:24:10Z INFO  prism_gpu::amber_simd_batch] SOTA MD complete: 500 steps, 3 Verlet rebuilds (avg 500.0 steps/rebuild)
[2026-02-11T19:24:10Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD complete: 500 steps
[2026-02-11T19:24:10Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 40 structures, 416120 atoms, 500 steps
[2026-02-11T19:24:10Z INFO  prism_gpu::amber_simd_batch] Using SOTA path with Verlet neighbor lists
