‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë     PRISM4D NHS RT-FULL - BATCH MODE (from manifest)          ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

[2026-02-07T06:31:07Z INFO  nhs_rt_full] Loading manifest: e2e_validation_test/batch_manifest_all14.json
[2026-02-07T06:31:07Z INFO  nhs_rt_full] Manifest loaded: 14 structures in 4 batches
[2026-02-07T06:31:07Z INFO  nhs_rt_full]   Collecting batch 0: 3 structures, 3 replicas (tier: Small)
[2026-02-07T06:31:07Z INFO  nhs_rt_full]   Collecting batch 1: 4 structures, 3 replicas (tier: Medium)
[2026-02-07T06:31:07Z INFO  nhs_rt_full]   Collecting batch 2: 5 structures, 3 replicas (tier: Large)
[2026-02-07T06:31:07Z INFO  nhs_rt_full]   Collecting batch 3: 2 structures, 3 replicas (tier: XLarge)
[2026-02-07T06:31:07Z INFO  nhs_rt_full] SIZE-TIER SEQUENTIAL BATCHING: 14 structures across 3 tiers
[2026-02-07T06:31:07Z INFO  nhs_rt_full]   Tier small (‚â§5K atoms): 3 structures (912-4692 atoms), 9 entries with 3 replicas
[2026-02-07T06:31:07Z INFO  nhs_rt_full]   Tier medium (5K-20K atoms): 4 structures (6816-17592 atoms), 12 entries with 3 replicas
[2026-02-07T06:31:07Z INFO  nhs_rt_full]   Tier large (>20K atoms): 7 structures (21783-68634 atoms), 21 entries with 3 replicas
[2026-02-07T06:31:07Z INFO  nhs_rt_full] Creating ONE CudaContext (device 0)...
[2026-02-07T06:31:07Z INFO  nhs_rt_full] ONE CudaContext. ZERO threads. 3 tiers sequentially.
[2026-02-07T06:31:07Z INFO  nhs_rt_full] ‚ïê‚ïê‚ïê Tier 1/3: small (‚â§5K atoms) (3 structures, max 4692 atoms) ‚ïê‚ïê‚ïê
[2026-02-07T06:31:07Z INFO  nhs_rt_full]     Creating AmberSimdBatch: 3 structures √ó 3 replicas = 9 total entries, max 4692 atoms
[2026-02-07T06:31:07Z INFO  prism_gpu::amber_simd_batch] AmberSimdBatch initialized: max 9 structures √ó 4692 atoms
[2026-02-07T06:31:07Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1l2y.topology.json
[2026-02-07T06:31:07Z INFO  prism_nhs::input] Loaded topology: 304 atoms, 20 residues, 1 chains
[2026-02-07T06:31:07Z INFO  nhs_rt_full]       Loaded: 1l2y_sanitized (912 atoms, 45 aromatics) ‚Üí 3 replicas starting at ID 0
[2026-02-07T06:31:07Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1crn.topology.json
[2026-02-07T06:31:07Z INFO  prism_nhs::input] Loaded topology: 642 atoms, 46 residues, 1 chains
[2026-02-07T06:31:07Z INFO  nhs_rt_full]       Loaded: 1crn_sanitized (1926 atoms, 62 aromatics) ‚Üí 3 replicas starting at ID 3
[2026-02-07T06:31:07Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1hhp.topology.json
[2026-02-07T06:31:07Z INFO  prism_nhs::input] Loaded topology: 1564 atoms, 99 residues, 1 chains
[2026-02-07T06:31:07Z INFO  nhs_rt_full]       Loaded: 1hhp_sanitized (4692 atoms, 110 aromatics) ‚Üí 3 replicas starting at ID 6
[2026-02-07T06:31:07Z INFO  nhs_rt_full]     Finalizing batch for GPU upload...
[2026-02-07T06:31:07Z INFO  prism_gpu::h_constraints] üîó HConstraints: 2382 clusters (1302 single, 729 CH2/NH2, 351 CH3/NH3)
[2026-02-07T06:31:07Z INFO  prism_gpu::amber_simd_batch] H-constraints: 2382 clusters (3813 total constraints, DOF adjusted)
[2026-02-07T06:31:07Z INFO  prism_gpu::amber_simd_batch] Initializing FP16 parameter buffers...
[2026-02-07T06:31:07Z INFO  prism_gpu::amber_simd_batch]   FP16 buffers: 7530 atoms (14 KB saved)
[2026-02-07T06:31:07Z INFO  prism_gpu::amber_simd_batch] Initializing Verlet neighbor list...
[2026-02-07T06:31:07Z INFO  prism_gpu::amber_simd_batch]   Verlet list: 7530 atoms, skin=2.0√Ö, rebuild threshold=1.0√Ö
[2026-02-07T06:31:07Z INFO  prism_gpu::amber_simd_batch] Initializing Tensor Core force calculator...
[2026-02-07T06:31:07Z INFO  prism_gpu::amber_simd_batch]   Tensor Cores: enabled (WMMA 16√ó16 tiles)
[2026-02-07T06:31:07Z INFO  prism_gpu::amber_simd_batch] Initializing async MD pipeline...
[2026-02-07T06:31:07Z INFO  prism_gpu::amber_simd_batch]   Async pipeline: enabled (bonded/non-bonded overlap)
[2026-02-07T06:31:07Z INFO  prism_gpu::amber_simd_batch] SOTA optimizations enabled:
[2026-02-07T06:31:07Z INFO  prism_gpu::amber_simd_batch]   - Verlet list: YES
[2026-02-07T06:31:07Z INFO  prism_gpu::amber_simd_batch]   - Tensor Cores: YES
[2026-02-07T06:31:07Z INFO  prism_gpu::amber_simd_batch]   - FP16 params: YES
[2026-02-07T06:31:07Z INFO  prism_gpu::amber_simd_batch]   - Async pipeline: YES
[2026-02-07T06:31:07Z INFO  prism_gpu::amber_simd_batch]   - Batched forces: YES
[2026-02-07T06:31:07Z INFO  prism_gpu::amber_simd_batch] Batch finalized: 9 structures, 7530 atoms
[2026-02-07T06:31:07Z INFO  nhs_rt_full]       ‚úì Batch ready: 9 total entries (3 structures √ó 3 replicas) on GPU
[2026-02-07T06:31:07Z INFO  nhs_rt_full]     Running 1000 steps per replica (batch executes in lockstep)...
[2026-02-07T06:31:07Z INFO  nhs_rt_full]       Protocol phases: cold=990, ramp=100, warm=0
[2026-02-07T06:31:07Z INFO  nhs_rt_full]     [1/3] Cold hold at 100K (990 steps)...
[2026-02-07T06:31:07Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 9 structures, 7530 atoms, 500 steps
[2026-02-07T06:31:07Z INFO  prism_gpu::amber_simd_batch] Using SOTA path with Verlet neighbor lists
[2026-02-07T06:31:10Z INFO  prism_gpu::amber_simd_batch] SOTA MD complete: 500 steps, 3 Verlet rebuilds (avg 166.7 steps/rebuild)
[2026-02-07T06:31:10Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD complete: 500 steps

thread 'main' (1481652) panicked at crates/prism-nhs/src/bin/nhs_rt_full.rs:1532:43:
range start index 28152 out of range for slice of length 22590
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
