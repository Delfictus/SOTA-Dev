â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     PRISM4D NHS RT-FULL - BATCH MODE (from manifest)          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[2026-02-05T21:27:52Z INFO  nhs_rt_full] Loading manifest: e2e_validation_test/batch_manifest_final.json
[2026-02-05T21:27:52Z INFO  nhs_rt_full] Manifest loaded: 10 structures in 3 batches
[2026-02-05T21:27:52Z INFO  nhs_rt_full] Flattening manifest batches into single unified batch...
[2026-02-05T21:27:52Z INFO  nhs_rt_full]   Total structures: 10
[2026-02-05T21:27:52Z INFO  nhs_rt_full]   Global max atoms: 22878
[2026-02-05T21:27:52Z INFO  nhs_rt_full]   Total entries (structureÃ—replicas): 150
[2026-02-05T21:27:52Z INFO  nhs_rt_full] Creating single CudaContext and AmberSimdBatch for all structures...
[2026-02-05T21:27:53Z INFO  prism_gpu::amber_simd_batch] AmberSimdBatch initialized: max 150 structures Ã— 22878 atoms
[2026-02-05T21:27:53Z INFO  nhs_rt_full] Loading all topologies into single batch...
[2026-02-05T21:27:53Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1ade.topology.json
[2026-02-05T21:27:53Z INFO  prism_nhs::input] Loaded topology: 13294 atoms, 862 residues, 2 chains
[2026-02-05T21:27:53Z INFO  nhs_rt_full]   [Batch 0] Loaded: 1ade_sanitized (13294 atoms, 1344 aromatics) â†’ 15 replicas starting at ID 0
[2026-02-05T21:27:53Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1bj4.topology.json
[2026-02-05T21:27:53Z INFO  prism_nhs::input] Loaded topology: 7261 atoms, 470 residues, 1 chains
[2026-02-05T21:27:53Z INFO  nhs_rt_full]   [Batch 0] Loaded: 1bj4_sanitized (7261 atoms, 767 aromatics) â†’ 15 replicas starting at ID 15
[2026-02-05T21:27:53Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1hhp.topology.json
[2026-02-05T21:27:53Z INFO  prism_nhs::input] Loaded topology: 1564 atoms, 99 residues, 1 chains
[2026-02-05T21:27:53Z INFO  nhs_rt_full]   [Batch 0] Loaded: 1hhp_sanitized (1564 atoms, 110 aromatics) â†’ 15 replicas starting at ID 30
[2026-02-05T21:27:53Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1qmf.topology.json
[2026-02-05T21:27:53Z INFO  prism_nhs::input] Loaded topology: 8460 atoms, 559 residues, 1 chains
[2026-02-05T21:27:53Z INFO  nhs_rt_full]   [Batch 0] Loaded: 1qmf_sanitized (8460 atoms, 877 aromatics) â†’ 15 replicas starting at ID 45
[2026-02-05T21:27:53Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1btl.topology.json
[2026-02-05T21:27:53Z INFO  prism_nhs::input] Loaded topology: 4073 atoms, 263 residues, 1 chains
[2026-02-05T21:27:53Z INFO  nhs_rt_full]   [Batch 1] Loaded: 1btl_sanitized (4073 atoms, 281 aromatics) â†’ 15 replicas starting at ID 60
[2026-02-05T21:27:53Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1a4q.topology.json
[2026-02-05T21:27:53Z INFO  prism_nhs::input] Loaded topology: 11926 atoms, 780 residues, 2 chains
[2026-02-05T21:27:53Z INFO  nhs_rt_full]   [Batch 1] Loaded: 1a4q_sanitized (11926 atoms, 1578 aromatics) â†’ 15 replicas starting at ID 75
[2026-02-05T21:27:53Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1ere.topology.json
[2026-02-05T21:27:53Z INFO  prism_nhs::input] Loaded topology: 22878 atoms, 1410 residues, 6 chains
[2026-02-05T21:27:53Z INFO  nhs_rt_full]   [Batch 1] Loaded: combined_chains (22878 atoms, 1776 aromatics) â†’ 15 replicas starting at ID 90
[2026-02-05T21:27:53Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1g1f.topology.json
[2026-02-05T21:27:53Z INFO  prism_nhs::input] Loaded topology: 4878 atoms, 301 residues, 2 chains
[2026-02-05T21:27:53Z INFO  nhs_rt_full]   [Batch 1] Loaded: 1g1f_sanitized (4878 atoms, 613 aromatics) â†’ 15 replicas starting at ID 105
[2026-02-05T21:27:53Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1igt.topology.json
[2026-02-05T21:27:53Z INFO  prism_nhs::input] Loaded topology: 20148 atoms, 1316 residues, 4 chains
[2026-02-05T21:27:53Z INFO  nhs_rt_full]   [Batch 2] Loaded: 1igt_sanitized (20148 atoms, 2686 aromatics) â†’ 15 replicas starting at ID 120
[2026-02-05T21:27:53Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1crn.topology.json
[2026-02-05T21:27:53Z INFO  prism_nhs::input] Loaded topology: 642 atoms, 46 residues, 1 chains
[2026-02-05T21:27:53Z INFO  nhs_rt_full]   [Batch 2] Loaded: 1crn_sanitized (642 atoms, 62 aromatics) â†’ 15 replicas starting at ID 135
[2026-02-05T21:27:53Z INFO  nhs_rt_full] Finalizing unified batch for GPU upload...
[2026-02-05T21:27:53Z INFO  prism_gpu::h_constraints] ğŸ”— HConstraints: 455940 clusters (261705 single, 132495 CH2/NH2, 61740 CH3/NH3)
[2026-02-05T21:27:53Z INFO  prism_gpu::amber_simd_batch] H-constraints: 455940 clusters (711915 total constraints, DOF adjusted)
[2026-02-05T21:27:53Z INFO  prism_gpu::amber_simd_batch] Initializing FP16 parameter buffers...
[2026-02-05T21:27:53Z INFO  prism_gpu::amber_simd_batch]   FP16 buffers: 1426860 atoms (2786 KB saved)
[2026-02-05T21:27:53Z INFO  prism_gpu::amber_simd_batch] Initializing Verlet neighbor list...
[2026-02-05T21:27:53Z INFO  prism_gpu::amber_simd_batch]   Verlet list: 1426860 atoms, skin=2.0Ã…, rebuild threshold=1.0Ã…
[2026-02-05T21:27:53Z INFO  prism_gpu::amber_simd_batch] Initializing Tensor Core force calculator...
[2026-02-05T21:27:53Z INFO  prism_gpu::amber_simd_batch]   Tensor Cores: enabled (WMMA 16Ã—16 tiles)
[2026-02-05T21:27:53Z INFO  prism_gpu::amber_simd_batch] Initializing async MD pipeline...
[2026-02-05T21:27:53Z INFO  prism_gpu::amber_simd_batch]   Async pipeline: enabled (bonded/non-bonded overlap)
[2026-02-05T21:27:53Z INFO  prism_gpu::amber_simd_batch] SOTA optimizations enabled:
[2026-02-05T21:27:53Z INFO  prism_gpu::amber_simd_batch]   - Verlet list: YES
[2026-02-05T21:27:53Z INFO  prism_gpu::amber_simd_batch]   - Tensor Cores: YES
[2026-02-05T21:27:53Z INFO  prism_gpu::amber_simd_batch]   - FP16 params: YES
[2026-02-05T21:27:53Z INFO  prism_gpu::amber_simd_batch]   - Async pipeline: YES
[2026-02-05T21:27:53Z INFO  prism_gpu::amber_simd_batch]   - Batched forces: YES
[2026-02-05T21:27:53Z INFO  prism_gpu::amber_simd_batch] Batch finalized: 150 structures, 1426860 atoms
[2026-02-05T21:27:53Z INFO  nhs_rt_full]   âœ“ Single batch ready: 150 total entries (10 structures across 3 manifest batches) on GPU
[2026-02-05T21:27:53Z INFO  nhs_rt_full] Running 50000 steps per entry (all entries execute in lockstep)...
[2026-02-05T21:27:53Z INFO  nhs_rt_full]   Protocol phases: cold=20000, ramp=8000, warm=22000
[2026-02-05T21:27:53Z INFO  nhs_rt_full] [1/3] Cold hold at 50K (20000 steps)...
[2026-02-05T21:27:53Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 150 structures, 1426860 atoms, 500 steps
[2026-02-05T21:27:53Z INFO  prism_gpu::amber_simd_batch] Using SOTA path with Verlet neighbor lists
[2026-02-05T21:34:43Z INFO  prism_gpu::amber_simd_batch] SOTA MD complete: 500 steps, 3 Verlet rebuilds (avg 166.7 steps/rebuild)
[2026-02-05T21:34:43Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD complete: 500 steps
[2026-02-05T21:34:43Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 150 structures, 1426860 atoms, 500 steps
[2026-02-05T21:34:43Z INFO  prism_gpu::amber_simd_batch] Using SOTA path with Verlet neighbor lists
[2026-02-05T21:41:33Z INFO  prism_gpu::amber_simd_batch] SOTA MD complete: 500 steps, 3 Verlet rebuilds (avg 333.3 steps/rebuild)
[2026-02-05T21:41:33Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD complete: 500 steps
[2026-02-05T21:41:34Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 150 structures, 1426860 atoms, 500 steps
[2026-02-05T21:41:34Z INFO  prism_gpu::amber_simd_batch] Using SOTA path with Verlet neighbor lists
[2026-02-05T21:48:23Z INFO  prism_gpu::amber_simd_batch] SOTA MD complete: 500 steps, 3 Verlet rebuilds (avg 500.0 steps/rebuild)
[2026-02-05T21:48:23Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD complete: 500 steps
[2026-02-05T21:48:23Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 150 structures, 1426860 atoms, 500 steps
[2026-02-05T21:48:23Z INFO  prism_gpu::amber_simd_batch] Using SOTA path with Verlet neighbor lists
