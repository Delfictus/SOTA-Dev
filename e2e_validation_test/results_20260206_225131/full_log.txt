â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     PRISM4D NHS RT-FULL - BATCH MODE (from manifest)          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[2026-02-07T06:51:31Z INFO  nhs_rt_full] Loading manifest: e2e_validation_test/batch_manifest_all14.json
[2026-02-07T06:51:31Z INFO  nhs_rt_full] Manifest loaded: 14 structures in 4 batches
[2026-02-07T06:51:31Z INFO  nhs_rt_full]   Collecting batch 0: 3 structures, 3 replicas (tier: Small)
[2026-02-07T06:51:31Z INFO  nhs_rt_full]   Collecting batch 1: 4 structures, 3 replicas (tier: Medium)
[2026-02-07T06:51:31Z INFO  nhs_rt_full]   Collecting batch 2: 5 structures, 3 replicas (tier: Large)
[2026-02-07T06:51:31Z INFO  nhs_rt_full]   Collecting batch 3: 2 structures, 3 replicas (tier: XLarge)
[2026-02-07T06:51:31Z INFO  nhs_rt_full] SIZE-TIER SEQUENTIAL BATCHING: 14 structures across 3 tiers
[2026-02-07T06:51:31Z INFO  nhs_rt_full]   Tier small (â‰¤5K atoms): 3 structures (912-4692 atoms), 9 entries with 3 replicas
[2026-02-07T06:51:31Z INFO  nhs_rt_full]   Tier medium (5K-20K atoms): 4 structures (6816-17592 atoms), 12 entries with 3 replicas
[2026-02-07T06:51:31Z INFO  nhs_rt_full]   Tier large (>20K atoms): 7 structures (21783-68634 atoms), 21 entries with 3 replicas
[2026-02-07T06:51:31Z INFO  nhs_rt_full] Creating ONE CudaContext (device 0)...
[2026-02-07T06:51:31Z INFO  nhs_rt_full] ONE CudaContext. ZERO threads. 3 tiers sequentially.
[2026-02-07T06:51:31Z INFO  nhs_rt_full] â•â•â• Tier 1/3: small (â‰¤5K atoms) (3 structures, max 4692 atoms) â•â•â•
[2026-02-07T06:51:31Z INFO  nhs_rt_full]     Creating AmberSimdBatch: 3 structures Ã— 3 replicas = 9 total entries, max 4692 atoms
[2026-02-07T06:51:31Z INFO  prism_gpu::amber_simd_batch] AmberSimdBatch initialized: max 9 structures Ã— 4692 atoms
[2026-02-07T06:51:31Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1l2y.topology.json
[2026-02-07T06:51:31Z INFO  prism_nhs::input] Loaded topology: 304 atoms, 20 residues, 1 chains
[2026-02-07T06:51:31Z INFO  nhs_rt_full]       Loaded: 1l2y_sanitized (912 atoms, 45 aromatics) â†’ 3 replicas starting at ID 0
[2026-02-07T06:51:31Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1crn.topology.json
[2026-02-07T06:51:31Z INFO  prism_nhs::input] Loaded topology: 642 atoms, 46 residues, 1 chains
[2026-02-07T06:51:31Z INFO  nhs_rt_full]       Loaded: 1crn_sanitized (1926 atoms, 62 aromatics) â†’ 3 replicas starting at ID 3
[2026-02-07T06:51:31Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1hhp.topology.json
[2026-02-07T06:51:31Z INFO  prism_nhs::input] Loaded topology: 1564 atoms, 99 residues, 1 chains
[2026-02-07T06:51:31Z INFO  nhs_rt_full]       Loaded: 1hhp_sanitized (4692 atoms, 110 aromatics) â†’ 3 replicas starting at ID 6
[2026-02-07T06:51:31Z INFO  nhs_rt_full]     Finalizing batch for GPU upload...
[2026-02-07T06:51:31Z INFO  prism_gpu::h_constraints] ğŸ”— HConstraints: 2382 clusters (1302 single, 729 CH2/NH2, 351 CH3/NH3)
[2026-02-07T06:51:31Z INFO  prism_gpu::amber_simd_batch] H-constraints: 2382 clusters (3813 total constraints, DOF adjusted)
[2026-02-07T06:51:31Z INFO  prism_gpu::amber_simd_batch] Initializing FP16 parameter buffers...
[2026-02-07T06:51:31Z INFO  prism_gpu::amber_simd_batch]   FP16 buffers: 7530 atoms (14 KB saved)
[2026-02-07T06:51:31Z INFO  prism_gpu::amber_simd_batch] Initializing Verlet neighbor list...
[2026-02-07T06:51:31Z INFO  prism_gpu::amber_simd_batch]   Verlet list: 7530 atoms, skin=2.0Ã…, rebuild threshold=1.0Ã…
[2026-02-07T06:51:31Z INFO  prism_gpu::amber_simd_batch] Initializing Tensor Core force calculator...
[2026-02-07T06:51:31Z INFO  prism_gpu::amber_simd_batch]   Tensor Cores: enabled (WMMA 16Ã—16 tiles)
[2026-02-07T06:51:31Z INFO  prism_gpu::amber_simd_batch] Initializing async MD pipeline...
[2026-02-07T06:51:31Z INFO  prism_gpu::amber_simd_batch]   Async pipeline: enabled (bonded/non-bonded overlap)
[2026-02-07T06:51:31Z INFO  prism_gpu::amber_simd_batch] SOTA optimizations enabled:
[2026-02-07T06:51:31Z INFO  prism_gpu::amber_simd_batch]   - Verlet list: YES
[2026-02-07T06:51:31Z INFO  prism_gpu::amber_simd_batch]   - Tensor Cores: YES
[2026-02-07T06:51:31Z INFO  prism_gpu::amber_simd_batch]   - FP16 params: YES
[2026-02-07T06:51:31Z INFO  prism_gpu::amber_simd_batch]   - Async pipeline: YES
[2026-02-07T06:51:31Z INFO  prism_gpu::amber_simd_batch]   - Batched forces: YES
[2026-02-07T06:51:31Z INFO  prism_gpu::amber_simd_batch] Batch finalized: 9 structures, 7530 atoms
[2026-02-07T06:51:31Z INFO  nhs_rt_full]       âœ“ Batch ready: 9 total entries (3 structures Ã— 3 replicas) on GPU
[2026-02-07T06:51:31Z INFO  nhs_rt_full]     Running 1000 steps per replica (batch executes in lockstep)...
[2026-02-07T06:51:31Z INFO  nhs_rt_full]       Protocol phases: cold=990, ramp=100, warm=0
[2026-02-07T06:51:31Z INFO  nhs_rt_full]     [1/3] Cold hold at 100K (990 steps)...
[2026-02-07T06:51:31Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 9 structures, 7530 atoms, 500 steps
[2026-02-07T06:51:31Z INFO  prism_gpu::amber_simd_batch] Using SOTA path with Verlet neighbor lists
[2026-02-07T06:51:34Z INFO  prism_gpu::amber_simd_batch] SOTA MD complete: 500 steps, 3 Verlet rebuilds (avg 166.7 steps/rebuild)
[2026-02-07T06:51:34Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD complete: 500 steps
[2026-02-07T06:51:34Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 9 structures, 7530 atoms, 490 steps
[2026-02-07T06:51:34Z INFO  prism_gpu::amber_simd_batch] Using SOTA path with Verlet neighbor lists
[2026-02-07T06:51:38Z INFO  prism_gpu::amber_simd_batch] SOTA MD complete: 490 steps, 3 Verlet rebuilds (avg 330.0 steps/rebuild)
[2026-02-07T06:51:38Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD complete: 490 steps
[2026-02-07T06:51:38Z INFO  nhs_rt_full]     [2/3] Ramping 100K â†’ 300K (100 steps)...
[2026-02-07T06:51:38Z INFO  nhs_rt_full]     âœ“ Batch MD complete in 6.7s
[2026-02-07T06:51:38Z INFO  prism_nhs::persistent_engine] ğŸš€ Initializing Persistent NHS Engine (max_atoms: 15000)
[2026-02-07T06:51:38Z INFO  prism_nhs::persistent_engine]   CUDA context: 0ms
[2026-02-07T06:51:38Z INFO  prism_nhs::persistent_engine]   PTX module: 3ms
[2026-02-07T06:51:38Z INFO  prism_nhs::persistent_engine] âœ… Persistent engine ready (total init: 3ms)
[2026-02-07T06:51:38Z INFO  nhs_rt_full]     Processing 1l2y_sanitized (3 replicas): 0 total raw spikes
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Replica 0: 0 spikes
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Replica 1: 0 spikes
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Replica 2: 0 spikes
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Replica 0: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Replica 1: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Replica 2: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Consensus analysis: site must appear in 3/3 replicas
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Consensus sites: 0
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Final binding sites: 0
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       âœ“ Complete: 0 sites (0 druggable) in 0.0s
[2026-02-07T06:51:38Z INFO  nhs_rt_full]     Processing 1crn_sanitized (3 replicas): 0 total raw spikes
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Replica 0: 0 spikes
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Replica 1: 0 spikes
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Replica 2: 0 spikes
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Replica 0: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Replica 1: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Replica 2: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Consensus analysis: site must appear in 3/3 replicas
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Consensus sites: 0
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Final binding sites: 0
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       âœ“ Complete: 0 sites (0 druggable) in 0.0s
[2026-02-07T06:51:38Z INFO  nhs_rt_full]     Processing 1hhp_sanitized (3 replicas): 0 total raw spikes
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Replica 0: 0 spikes
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Replica 1: 0 spikes
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Replica 2: 0 spikes
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Replica 0: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Replica 1: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Replica 2: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Consensus analysis: site must appear in 3/3 replicas
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Consensus sites: 0
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Final binding sites: 0
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       âœ“ Complete: 0 sites (0 druggable) in 0.0s
[2026-02-07T06:51:38Z INFO  nhs_rt_full]   Tier small (â‰¤5K atoms) complete: 3/3 successful in 6.7s
[2026-02-07T06:51:38Z INFO  nhs_rt_full]   Tier small (â‰¤5K atoms) batch dropped, GPU memory freed.
[2026-02-07T06:51:38Z INFO  nhs_rt_full] â•â•â• Tier 2/3: medium (5K-20K atoms) (4 structures, max 17592 atoms) â•â•â•
[2026-02-07T06:51:38Z INFO  nhs_rt_full]     Creating AmberSimdBatch: 4 structures Ã— 3 replicas = 12 total entries, max 17592 atoms
[2026-02-07T06:51:38Z INFO  prism_gpu::amber_simd_batch] AmberSimdBatch initialized: max 12 structures Ã— 17592 atoms
[2026-02-07T06:51:38Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1maz.topology.json
[2026-02-07T06:51:38Z INFO  prism_nhs::input] Loaded topology: 2272 atoms, 143 residues, 1 chains
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Loaded: 1maz_sanitized (6816 atoms, 446 aromatics) â†’ 3 replicas starting at ID 0
[2026-02-07T06:51:38Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1btl.topology.json
[2026-02-07T06:51:38Z INFO  prism_nhs::input] Loaded topology: 4073 atoms, 263 residues, 1 chains
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Loaded: 1btl_sanitized (12219 atoms, 281 aromatics) â†’ 3 replicas starting at ID 3
[2026-02-07T06:51:38Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1g1f.topology.json
[2026-02-07T06:51:38Z INFO  prism_nhs::input] Loaded topology: 4878 atoms, 301 residues, 2 chains
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Loaded: 1g1f_sanitized (14634 atoms, 613 aromatics) â†’ 3 replicas starting at ID 6
[2026-02-07T06:51:38Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1w50.topology.json
[2026-02-07T06:51:38Z INFO  prism_nhs::input] Loaded topology: 5864 atoms, 378 residues, 1 chains
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Loaded: 1w50_sanitized (17592 atoms, 949 aromatics) â†’ 3 replicas starting at ID 9
[2026-02-07T06:51:38Z INFO  nhs_rt_full]     Finalizing batch for GPU upload...
[2026-02-07T06:51:38Z INFO  prism_gpu::h_constraints] ğŸ”— HConstraints: 16425 clusters (9540 single, 4818 CH2/NH2, 2067 CH3/NH3)
[2026-02-07T06:51:38Z INFO  prism_gpu::amber_simd_batch] H-constraints: 16425 clusters (25377 total constraints, DOF adjusted)
[2026-02-07T06:51:38Z INFO  prism_gpu::amber_simd_batch] Initializing FP16 parameter buffers...
[2026-02-07T06:51:38Z INFO  prism_gpu::amber_simd_batch]   FP16 buffers: 51261 atoms (100 KB saved)
[2026-02-07T06:51:38Z INFO  prism_gpu::amber_simd_batch] Initializing Verlet neighbor list...
[2026-02-07T06:51:38Z INFO  prism_gpu::amber_simd_batch]   Verlet list: 51261 atoms, skin=2.0Ã…, rebuild threshold=1.0Ã…
[2026-02-07T06:51:38Z INFO  prism_gpu::amber_simd_batch] Initializing Tensor Core force calculator...
[2026-02-07T06:51:38Z INFO  prism_gpu::amber_simd_batch]   Tensor Cores: enabled (WMMA 16Ã—16 tiles)
[2026-02-07T06:51:38Z INFO  prism_gpu::amber_simd_batch] Initializing async MD pipeline...
[2026-02-07T06:51:38Z INFO  prism_gpu::amber_simd_batch]   Async pipeline: enabled (bonded/non-bonded overlap)
[2026-02-07T06:51:38Z INFO  prism_gpu::amber_simd_batch] SOTA optimizations enabled:
[2026-02-07T06:51:38Z INFO  prism_gpu::amber_simd_batch]   - Verlet list: YES
[2026-02-07T06:51:38Z INFO  prism_gpu::amber_simd_batch]   - Tensor Cores: YES
[2026-02-07T06:51:38Z INFO  prism_gpu::amber_simd_batch]   - FP16 params: YES
[2026-02-07T06:51:38Z INFO  prism_gpu::amber_simd_batch]   - Async pipeline: YES
[2026-02-07T06:51:38Z INFO  prism_gpu::amber_simd_batch]   - Batched forces: YES
[2026-02-07T06:51:38Z INFO  prism_gpu::amber_simd_batch] Batch finalized: 12 structures, 51261 atoms
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       âœ“ Batch ready: 12 total entries (4 structures Ã— 3 replicas) on GPU
[2026-02-07T06:51:38Z INFO  nhs_rt_full]     Running 1000 steps per replica (batch executes in lockstep)...
[2026-02-07T06:51:38Z INFO  nhs_rt_full]       Protocol phases: cold=990, ramp=100, warm=0
[2026-02-07T06:51:38Z INFO  nhs_rt_full]     [1/3] Cold hold at 100K (990 steps)...
[2026-02-07T06:51:38Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 12 structures, 51261 atoms, 500 steps
[2026-02-07T06:51:38Z INFO  prism_gpu::amber_simd_batch] Using SOTA path with Verlet neighbor lists
[2026-02-07T06:51:51Z INFO  prism_gpu::amber_simd_batch] SOTA MD complete: 500 steps, 3 Verlet rebuilds (avg 166.7 steps/rebuild)
[2026-02-07T06:51:51Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD complete: 500 steps
[2026-02-07T06:51:51Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 12 structures, 51261 atoms, 490 steps
[2026-02-07T06:51:51Z INFO  prism_gpu::amber_simd_batch] Using SOTA path with Verlet neighbor lists
[2026-02-07T06:52:04Z INFO  prism_gpu::amber_simd_batch] SOTA MD complete: 490 steps, 3 Verlet rebuilds (avg 330.0 steps/rebuild)
[2026-02-07T06:52:04Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD complete: 490 steps
[2026-02-07T06:52:04Z INFO  nhs_rt_full]     [2/3] Ramping 100K â†’ 300K (100 steps)...
[2026-02-07T06:52:04Z INFO  nhs_rt_full]     âœ“ Batch MD complete in 26.0s
[2026-02-07T06:52:04Z INFO  prism_nhs::persistent_engine] ğŸš€ Initializing Persistent NHS Engine (max_atoms: 17592)
[2026-02-07T06:52:04Z INFO  prism_nhs::persistent_engine]   CUDA context: 0ms
[2026-02-07T06:52:04Z INFO  prism_nhs::persistent_engine]   PTX module: 2ms
[2026-02-07T06:52:04Z INFO  prism_nhs::persistent_engine] âœ… Persistent engine ready (total init: 2ms)
[2026-02-07T06:52:04Z INFO  nhs_rt_full]     Processing 1maz_sanitized (3 replicas): 0 total raw spikes
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 0: 0 spikes
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 1: 0 spikes
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 2: 0 spikes
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 0: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 1: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 2: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Consensus analysis: site must appear in 3/3 replicas
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Consensus sites: 0
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Final binding sites: 0
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       âœ“ Complete: 0 sites (0 druggable) in 0.0s
[2026-02-07T06:52:04Z INFO  nhs_rt_full]     Processing 1btl_sanitized (3 replicas): 0 total raw spikes
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 0: 0 spikes
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 1: 0 spikes
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 2: 0 spikes
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 0: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 1: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 2: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Consensus analysis: site must appear in 3/3 replicas
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Consensus sites: 0
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Final binding sites: 0
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       âœ“ Complete: 0 sites (0 druggable) in 0.0s
[2026-02-07T06:52:04Z INFO  nhs_rt_full]     Processing 1g1f_sanitized (3 replicas): 0 total raw spikes
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 0: 0 spikes
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 1: 0 spikes
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 2: 0 spikes
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 0: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 1: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 2: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Consensus analysis: site must appear in 3/3 replicas
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Consensus sites: 0
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Final binding sites: 0
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       âœ“ Complete: 0 sites (0 druggable) in 0.0s
[2026-02-07T06:52:04Z INFO  nhs_rt_full]     Processing 1w50_sanitized (3 replicas): 0 total raw spikes
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 0: 0 spikes
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 1: 0 spikes
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 2: 0 spikes
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 0: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 1: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Replica 2: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Consensus analysis: site must appear in 3/3 replicas
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Consensus sites: 0
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Final binding sites: 0
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       âœ“ Complete: 0 sites (0 druggable) in 0.0s
[2026-02-07T06:52:04Z INFO  nhs_rt_full]   Tier medium (5K-20K atoms) complete: 4/4 successful in 26.0s
[2026-02-07T06:52:04Z INFO  nhs_rt_full]   Tier medium (5K-20K atoms) batch dropped, GPU memory freed.
[2026-02-07T06:52:04Z INFO  nhs_rt_full] â•â•â• Tier 3/3: large (>20K atoms) (7 structures, max 68634 atoms) â•â•â•
[2026-02-07T06:52:04Z INFO  nhs_rt_full]     Creating AmberSimdBatch: 7 structures Ã— 3 replicas = 21 total entries, max 68634 atoms
[2026-02-07T06:52:04Z INFO  prism_gpu::amber_simd_batch] AmberSimdBatch initialized: max 21 structures Ã— 68634 atoms
[2026-02-07T06:52:04Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1bj4.topology.json
[2026-02-07T06:52:04Z INFO  prism_nhs::input] Loaded topology: 7261 atoms, 470 residues, 1 chains
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Loaded: 1bj4_sanitized (21783 atoms, 767 aromatics) â†’ 3 replicas starting at ID 0
[2026-02-07T06:52:04Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1qmf.topology.json
[2026-02-07T06:52:04Z INFO  prism_nhs::input] Loaded topology: 8460 atoms, 559 residues, 1 chains
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Loaded: 1qmf_sanitized (25380 atoms, 877 aromatics) â†’ 3 replicas starting at ID 3
[2026-02-07T06:52:04Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/3k5v.topology.json
[2026-02-07T06:52:04Z INFO  prism_nhs::input] Loaded topology: 9139 atoms, 569 residues, 2 chains
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Loaded: 3k5v_sanitized (27417 atoms, 1448 aromatics) â†’ 3 replicas starting at ID 6
[2026-02-07T06:52:04Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1a4q.topology.json
[2026-02-07T06:52:04Z INFO  prism_nhs::input] Loaded topology: 11926 atoms, 780 residues, 2 chains
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Loaded: 1a4q_sanitized (35778 atoms, 1578 aromatics) â†’ 3 replicas starting at ID 9
[2026-02-07T06:52:04Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1ade.topology.json
[2026-02-07T06:52:04Z INFO  prism_nhs::input] Loaded topology: 13294 atoms, 862 residues, 2 chains
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Loaded: 1ade_sanitized (39882 atoms, 1344 aromatics) â†’ 3 replicas starting at ID 12
[2026-02-07T06:52:04Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1igt.topology.json
[2026-02-07T06:52:04Z INFO  prism_nhs::input] Loaded topology: 20148 atoms, 1316 residues, 4 chains
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Loaded: 1igt_sanitized (60444 atoms, 2686 aromatics) â†’ 3 replicas starting at ID 15
[2026-02-07T06:52:04Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1ere.topology.json
[2026-02-07T06:52:04Z INFO  prism_nhs::input] Loaded topology: 22878 atoms, 1410 residues, 6 chains
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Loaded: 1ere_sanitized (68634 atoms, 1776 aromatics) â†’ 3 replicas starting at ID 18
[2026-02-07T06:52:04Z INFO  nhs_rt_full]     Finalizing batch for GPU upload...
[2026-02-07T06:52:04Z INFO  prism_gpu::h_constraints] ğŸ”— HConstraints: 67530 clusters (39273 single, 19698 CH2/NH2, 8559 CH3/NH3)
[2026-02-07T06:52:04Z INFO  prism_gpu::amber_simd_batch] H-constraints: 67530 clusters (104346 total constraints, DOF adjusted)
[2026-02-07T06:52:04Z INFO  prism_gpu::amber_simd_batch] Initializing FP16 parameter buffers...
[2026-02-07T06:52:04Z INFO  prism_gpu::amber_simd_batch]   FP16 buffers: 279318 atoms (545 KB saved)
[2026-02-07T06:52:04Z INFO  prism_gpu::amber_simd_batch] Initializing Verlet neighbor list...
[2026-02-07T06:52:04Z INFO  prism_gpu::amber_simd_batch]   Verlet list: 279318 atoms, skin=2.0Ã…, rebuild threshold=1.0Ã…
[2026-02-07T06:52:04Z INFO  prism_gpu::amber_simd_batch] Initializing Tensor Core force calculator...
[2026-02-07T06:52:04Z INFO  prism_gpu::amber_simd_batch]   Tensor Cores: enabled (WMMA 16Ã—16 tiles)
[2026-02-07T06:52:04Z INFO  prism_gpu::amber_simd_batch] Initializing async MD pipeline...
[2026-02-07T06:52:04Z INFO  prism_gpu::amber_simd_batch]   Async pipeline: enabled (bonded/non-bonded overlap)
[2026-02-07T06:52:04Z INFO  prism_gpu::amber_simd_batch] SOTA optimizations enabled:
[2026-02-07T06:52:04Z INFO  prism_gpu::amber_simd_batch]   - Verlet list: YES
[2026-02-07T06:52:04Z INFO  prism_gpu::amber_simd_batch]   - Tensor Cores: YES
[2026-02-07T06:52:04Z INFO  prism_gpu::amber_simd_batch]   - FP16 params: YES
[2026-02-07T06:52:04Z INFO  prism_gpu::amber_simd_batch]   - Async pipeline: YES
[2026-02-07T06:52:04Z INFO  prism_gpu::amber_simd_batch]   - Batched forces: YES
[2026-02-07T06:52:04Z INFO  prism_gpu::amber_simd_batch] Batch finalized: 21 structures, 279318 atoms
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       âœ“ Batch ready: 21 total entries (7 structures Ã— 3 replicas) on GPU
[2026-02-07T06:52:04Z INFO  nhs_rt_full]     Running 1000 steps per replica (batch executes in lockstep)...
[2026-02-07T06:52:04Z INFO  nhs_rt_full]       Protocol phases: cold=990, ramp=100, warm=0
[2026-02-07T06:52:04Z INFO  nhs_rt_full]     [1/3] Cold hold at 100K (990 steps)...
[2026-02-07T06:52:04Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 21 structures, 279318 atoms, 500 steps
[2026-02-07T06:52:04Z INFO  prism_gpu::amber_simd_batch] Using SOTA path with Verlet neighbor lists
[2026-02-07T06:52:46Z INFO  prism_gpu::amber_simd_batch] SOTA MD complete: 500 steps, 3 Verlet rebuilds (avg 166.7 steps/rebuild)
[2026-02-07T06:52:46Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD complete: 500 steps
[2026-02-07T06:52:46Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 21 structures, 279318 atoms, 490 steps
[2026-02-07T06:52:46Z INFO  prism_gpu::amber_simd_batch] Using SOTA path with Verlet neighbor lists
[2026-02-07T06:53:28Z INFO  prism_gpu::amber_simd_batch] SOTA MD complete: 490 steps, 3 Verlet rebuilds (avg 330.0 steps/rebuild)
[2026-02-07T06:53:28Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD complete: 490 steps
[2026-02-07T06:53:28Z INFO  nhs_rt_full]     [2/3] Ramping 100K â†’ 300K (100 steps)...
[2026-02-07T06:53:28Z INFO  nhs_rt_full]     âœ“ Batch MD complete in 84.0s
[2026-02-07T06:53:28Z INFO  prism_nhs::persistent_engine] ğŸš€ Initializing Persistent NHS Engine (max_atoms: 68634)
[2026-02-07T06:53:28Z INFO  prism_nhs::persistent_engine]   CUDA context: 0ms
[2026-02-07T06:53:28Z INFO  prism_nhs::persistent_engine]   PTX module: 2ms
[2026-02-07T06:53:28Z INFO  prism_nhs::persistent_engine] âœ… Persistent engine ready (total init: 2ms)
[2026-02-07T06:53:28Z INFO  nhs_rt_full]     Processing 1bj4_sanitized (3 replicas): 0 total raw spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 0: 0 spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 1: 0 spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 2: 0 spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 0: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 1: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 2: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Consensus analysis: site must appear in 3/3 replicas
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Consensus sites: 0
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Final binding sites: 0
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       âœ“ Complete: 0 sites (0 druggable) in 0.0s
[2026-02-07T06:53:28Z INFO  nhs_rt_full]     Processing 1qmf_sanitized (3 replicas): 0 total raw spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 0: 0 spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 1: 0 spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 2: 0 spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 0: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 1: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 2: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Consensus analysis: site must appear in 3/3 replicas
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Consensus sites: 0
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Final binding sites: 0
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       âœ“ Complete: 0 sites (0 druggable) in 0.0s
[2026-02-07T06:53:28Z INFO  nhs_rt_full]     Processing 3k5v_sanitized (3 replicas): 0 total raw spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 0: 0 spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 1: 0 spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 2: 0 spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 0: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 1: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 2: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Consensus analysis: site must appear in 3/3 replicas
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Consensus sites: 0
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Final binding sites: 0
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       âœ“ Complete: 0 sites (0 druggable) in 0.0s
[2026-02-07T06:53:28Z INFO  nhs_rt_full]     Processing 1a4q_sanitized (3 replicas): 0 total raw spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 0: 0 spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 1: 0 spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 2: 0 spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 0: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 1: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 2: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Consensus analysis: site must appear in 3/3 replicas
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Consensus sites: 0
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Final binding sites: 0
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       âœ“ Complete: 0 sites (0 druggable) in 0.0s
[2026-02-07T06:53:28Z INFO  nhs_rt_full]     Processing 1ade_sanitized (3 replicas): 0 total raw spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 0: 0 spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 1: 0 spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 2: 0 spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 0: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 1: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 2: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Consensus analysis: site must appear in 3/3 replicas
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Consensus sites: 0
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Final binding sites: 0
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       âœ“ Complete: 0 sites (0 druggable) in 0.0s
[2026-02-07T06:53:28Z INFO  nhs_rt_full]     Processing 1igt_sanitized (3 replicas): 0 total raw spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 0: 0 spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 1: 0 spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 2: 0 spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 0: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 1: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 2: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Consensus analysis: site must appear in 3/3 replicas
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Consensus sites: 0
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Final binding sites: 0
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       âœ“ Complete: 0 sites (0 druggable) in 0.0s
[2026-02-07T06:53:28Z INFO  nhs_rt_full]     Processing 1ere_sanitized (3 replicas): 0 total raw spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 0: 0 spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 1: 0 spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 2: 0 spikes
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 0: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 1: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Replica 2: 0 filtered spikes â†’ 0 sites
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Consensus analysis: site must appear in 3/3 replicas
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Consensus sites: 0
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       Final binding sites: 0
[2026-02-07T06:53:28Z INFO  nhs_rt_full]       âœ“ Complete: 0 sites (0 druggable) in 0.0s
[2026-02-07T06:53:28Z INFO  nhs_rt_full]   Tier large (>20K atoms) complete: 7/7 successful in 84.0s
[2026-02-07T06:53:28Z INFO  nhs_rt_full]   Tier large (>20K atoms) batch dropped, GPU memory freed.

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    BATCH RUN COMPLETE                         â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ Total structures:   14                                       â•‘
â•‘ Successful:         14                                       â•‘
â•‘ Failed:              0                                       â•‘
â•‘ Size tiers:          3                                       â•‘
â•‘ Total time:        116.8s                                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Summary written to: e2e_validation_test/results_20260206_225131/batch_summary.json
