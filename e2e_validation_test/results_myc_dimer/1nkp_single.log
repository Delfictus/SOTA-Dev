[2026-02-08T23:15:54Z INFO  nhs_rt_full] â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
[2026-02-08T23:15:54Z INFO  nhs_rt_full] â•‘     PRISM4D NHS RT-FULL PIPELINE                              â•‘
[2026-02-08T23:15:54Z INFO  nhs_rt_full] â•‘     RT-Core Accelerated Binding Site Detection                â•‘
[2026-02-08T23:15:54Z INFO  nhs_rt_full] â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-02-08T23:15:54Z INFO  nhs_rt_full] 
    [1/6] Loading topology: e2e_validation_test/prep/1nkp_dimer.topology.json
[2026-02-08T23:15:54Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: e2e_validation_test/prep/1nkp_dimer.topology.json
[2026-02-08T23:15:54Z INFO  prism_nhs::input] Loaded topology: 2879 atoms, 171 residues, 2 chains
[2026-02-08T23:15:54Z INFO  nhs_rt_full]   Atoms: 2879
[2026-02-08T23:15:54Z INFO  nhs_rt_full]   Residues: 171
[2026-02-08T23:15:54Z INFO  nhs_rt_full]   Aromatics: 6 (TRP/TYR/PHE)
[2026-02-08T23:15:54Z INFO  nhs_rt_full] 
    [2/6] Initializing GPU engine...
[2026-02-08T23:15:54Z INFO  prism_nhs::persistent_engine] ğŸš€ Initializing Persistent NHS Engine (max_atoms: 15000)
[2026-02-08T23:15:54Z INFO  prism_nhs::persistent_engine]   CUDA context: 117ms
[2026-02-08T23:15:54Z INFO  prism_nhs::persistent_engine]   PTX module: 2ms
[2026-02-08T23:15:54Z INFO  prism_nhs::persistent_engine] âœ… Persistent engine ready (total init: 119ms)
[2026-02-08T23:15:54Z INFO  prism_nhs::persistent_engine] ğŸ“¦ Loading topology: 1nkp_dimer (2879 atoms)
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine] Creating NHS-AMBER Fused Engine: 2879 atoms, grid 64Â³
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine] Loaded fused kernel PTX from: crates/prism-gpu/src/kernels/nhs_amber_fused.ptx
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine] Cell grid: 7x12x10 = 840 cells (cell size 10 Ã…)
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine] Neighbor list mode: ENABLED (O(N)) (n_atoms=2879)
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine] Uploaded aromatic topology: 6 aromatics with ring atom indices
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine] Uploaded topology: 2895 bonds, 5233 angles, 9627 dihedrals
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine] Excited state: 6 aromatics mapped
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine] Built warp matrix: 262144 voxels (32453 with atoms, avg 1.6 atoms/voxel, max 16)
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine] Built aromatic neighbor lists for 6 aromatics (cutoff 5.0A)
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine] Computed ring normals for 6 aromatics
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine] Computed and uploaded aromatic centroids for 6 aromatics
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine] NHS-AMBER Fused Engine created successfully
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine]   Bonds: 2895, Angles: 5233, Dihedrals: 9627
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine]   H-Clusters (SHAKE): 906
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine]   UV Targets: 6
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine]   Cryogenic physics: ENABLED
[2026-02-08T23:15:54Z INFO  prism_nhs::persistent_engine]   Topology loaded: 490ms
[2026-02-08T23:15:54Z INFO  nhs_rt_full]   RT-core clustering: âœ“ Available
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine] â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine] â•‘  UNIFIED CRYO-UV PROTOCOL ACTIVATED                           â•‘
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine] â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine]   Temperature: 100K â†’ 300K
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine]   Phases: cold_hold=50000, ramp=6250, warm_hold=6250
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine]   UV bursts: 50kcal/mol every 250 steps (50 step duration)
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine]   Wavelengths: [280.0, 274.0, 258.0, 211.0] nm
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine]   âœ“ UV-LIF coupling: ACTIVE (100% aromatic localization)
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine] Spike accumulation: ENABLED
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine] Enabling hyperoptimized ultimate kernel mode...
[2026-02-08T23:15:54Z INFO  prism_nhs::ultimate_engine] Creating Ultimate Hyperoptimized Engine: 2879 atoms
[2026-02-08T23:15:54Z INFO  prism_nhs::ultimate_engine] Loaded ultimate_md.ptx from: crates/prism-gpu/src/kernels/ultimate_md.ptx
[2026-02-08T23:15:54Z INFO  prism_nhs::fused_engine] Ultimate mode enabled: SoA layout, occupancy tuning, all 14 optimizations active
[2026-02-08T23:15:54Z INFO  prism_nhs::persistent_engine] âœ“ UltimateEngine enabled (2-4x faster MD)
[2026-02-08T23:15:54Z INFO  nhs_rt_full]   UltimateEngine: âœ“ Enabled (2-4x faster MD)
[2026-02-08T23:15:54Z INFO  nhs_rt_full] 
    [3/6] Running MD simulation (50000 steps x 10 replicas)...
[2026-02-08T23:15:54Z INFO  nhs_rt_full]   Mode: SEQUENTIAL (10 replicas one at a time)
[2026-02-08T23:15:54Z INFO  nhs_rt_full]   Replica 1/10 (seed: 42)...
[2026-02-08T23:16:02Z INFO  prism_nhs::fused_engine] Captured 10 ensemble snapshots (avg quality: 0.63)
[2026-02-08T23:16:02Z INFO  prism_nhs::fused_engine] Step 10000: T=300.0K, spikes=231715
[2026-02-08T23:16:08Z INFO  prism_nhs::fused_engine] Captured 20 ensemble snapshots (avg quality: 0.65)
[2026-02-08T23:16:08Z INFO  prism_nhs::fused_engine] Step 20000: T=300.0K, spikes=227309
[2026-02-08T23:16:15Z INFO  prism_nhs::fused_engine] Captured 30 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:16:15Z INFO  prism_nhs::fused_engine] Step 30000: T=300.0K, spikes=225097
[2026-02-08T23:16:22Z INFO  prism_nhs::fused_engine] Captured 40 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:16:22Z INFO  prism_nhs::fused_engine] Step 40000: T=300.0K, spikes=222542
[2026-02-08T23:16:28Z INFO  prism_nhs::fused_engine] Captured 50 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:16:28Z INFO  prism_nhs::fused_engine] Step 50000: T=300.0K, spikes=220971
[2026-02-08T23:16:29Z INFO  nhs_rt_full]     Replica 1 complete: 5000000 spikes, T=300.0K
[2026-02-08T23:16:29Z INFO  nhs_rt_full]   Replica 2/10 (seed: 43)...
[2026-02-08T23:16:35Z INFO  prism_nhs::fused_engine] Captured 10 ensemble snapshots (avg quality: 0.63)
[2026-02-08T23:16:35Z INFO  prism_nhs::fused_engine] Step 10000: T=300.0K, spikes=218001
[2026-02-08T23:16:42Z INFO  prism_nhs::fused_engine] Captured 20 ensemble snapshots (avg quality: 0.65)
[2026-02-08T23:16:42Z INFO  prism_nhs::fused_engine] Step 20000: T=300.0K, spikes=216089
[2026-02-08T23:16:48Z INFO  prism_nhs::fused_engine] Captured 30 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:16:48Z INFO  prism_nhs::fused_engine] Step 30000: T=300.0K, spikes=215877
[2026-02-08T23:16:55Z INFO  prism_nhs::fused_engine] Captured 40 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:16:55Z INFO  prism_nhs::fused_engine] Step 40000: T=300.0K, spikes=212231
[2026-02-08T23:17:02Z INFO  prism_nhs::fused_engine] Captured 50 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:17:02Z INFO  prism_nhs::fused_engine] Step 50000: T=300.0K, spikes=209961
[2026-02-08T23:17:02Z INFO  nhs_rt_full]     Replica 2 complete: 5000000 spikes, T=300.0K
[2026-02-08T23:17:02Z INFO  nhs_rt_full]   Replica 3/10 (seed: 44)...
[2026-02-08T23:17:09Z INFO  prism_nhs::fused_engine] Captured 10 ensemble snapshots (avg quality: 0.63)
[2026-02-08T23:17:09Z INFO  prism_nhs::fused_engine] Step 10000: T=300.0K, spikes=206645
[2026-02-08T23:17:15Z INFO  prism_nhs::fused_engine] Captured 20 ensemble snapshots (avg quality: 0.65)
[2026-02-08T23:17:15Z INFO  prism_nhs::fused_engine] Step 20000: T=300.0K, spikes=203967
[2026-02-08T23:17:22Z INFO  prism_nhs::fused_engine] Captured 30 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:17:22Z INFO  prism_nhs::fused_engine] Step 30000: T=300.0K, spikes=201707
[2026-02-08T23:17:29Z INFO  prism_nhs::fused_engine] Captured 40 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:17:29Z INFO  prism_nhs::fused_engine] Step 40000: T=300.0K, spikes=199151
[2026-02-08T23:17:35Z INFO  prism_nhs::fused_engine] Captured 50 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:17:35Z INFO  prism_nhs::fused_engine] Step 50000: T=300.0K, spikes=197416
[2026-02-08T23:17:35Z INFO  nhs_rt_full]     Replica 3 complete: 5000000 spikes, T=300.0K
[2026-02-08T23:17:35Z INFO  nhs_rt_full]   Replica 4/10 (seed: 45)...
[2026-02-08T23:17:42Z INFO  prism_nhs::fused_engine] Captured 10 ensemble snapshots (avg quality: 0.63)
[2026-02-08T23:17:42Z INFO  prism_nhs::fused_engine] Step 10000: T=300.0K, spikes=195334
[2026-02-08T23:17:49Z INFO  prism_nhs::fused_engine] Captured 20 ensemble snapshots (avg quality: 0.65)
[2026-02-08T23:17:49Z INFO  prism_nhs::fused_engine] Step 20000: T=300.0K, spikes=193437
[2026-02-08T23:17:55Z INFO  prism_nhs::fused_engine] Captured 30 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:17:55Z INFO  prism_nhs::fused_engine] Step 30000: T=300.0K, spikes=190120
[2026-02-08T23:18:02Z INFO  prism_nhs::fused_engine] Captured 40 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:18:02Z INFO  prism_nhs::fused_engine] Step 40000: T=300.0K, spikes=187235
[2026-02-08T23:18:09Z INFO  prism_nhs::fused_engine] Captured 50 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:18:09Z INFO  prism_nhs::fused_engine] Step 50000: T=300.0K, spikes=185074
[2026-02-08T23:18:09Z INFO  nhs_rt_full]     Replica 4 complete: 5000000 spikes, T=300.0K
[2026-02-08T23:18:09Z INFO  nhs_rt_full]   Replica 5/10 (seed: 46)...
[2026-02-08T23:18:16Z INFO  prism_nhs::fused_engine] Captured 10 ensemble snapshots (avg quality: 0.63)
[2026-02-08T23:18:16Z INFO  prism_nhs::fused_engine] Step 10000: T=300.0K, spikes=183319
[2026-02-08T23:18:22Z INFO  prism_nhs::fused_engine] Captured 20 ensemble snapshots (avg quality: 0.65)
[2026-02-08T23:18:22Z INFO  prism_nhs::fused_engine] Step 20000: T=300.0K, spikes=181950
[2026-02-08T23:18:29Z INFO  prism_nhs::fused_engine] Captured 30 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:18:29Z INFO  prism_nhs::fused_engine] Step 30000: T=300.0K, spikes=180255
[2026-02-08T23:18:36Z INFO  prism_nhs::fused_engine] Captured 40 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:18:36Z INFO  prism_nhs::fused_engine] Step 40000: T=300.0K, spikes=179438
[2026-02-08T23:18:42Z INFO  prism_nhs::fused_engine] Captured 50 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:18:42Z INFO  prism_nhs::fused_engine] Step 50000: T=300.0K, spikes=178168
[2026-02-08T23:18:42Z INFO  nhs_rt_full]     Replica 5 complete: 5000000 spikes, T=300.0K
[2026-02-08T23:18:42Z INFO  nhs_rt_full]   Replica 6/10 (seed: 47)...
[2026-02-08T23:18:49Z INFO  prism_nhs::fused_engine] Captured 10 ensemble snapshots (avg quality: 0.63)
[2026-02-08T23:18:49Z INFO  prism_nhs::fused_engine] Step 10000: T=300.0K, spikes=177154
[2026-02-08T23:18:56Z INFO  prism_nhs::fused_engine] Captured 20 ensemble snapshots (avg quality: 0.65)
[2026-02-08T23:18:56Z INFO  prism_nhs::fused_engine] Step 20000: T=300.0K, spikes=176289
[2026-02-08T23:19:02Z INFO  prism_nhs::fused_engine] Captured 30 ensemble snapshots (avg quality: 0.65)
[2026-02-08T23:19:02Z INFO  prism_nhs::fused_engine] Step 30000: T=300.0K, spikes=174101
[2026-02-08T23:19:09Z INFO  prism_nhs::fused_engine] Captured 40 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:19:09Z INFO  prism_nhs::fused_engine] Step 40000: T=300.0K, spikes=173089
[2026-02-08T23:19:15Z INFO  prism_nhs::fused_engine] Captured 50 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:19:15Z INFO  prism_nhs::fused_engine] Step 50000: T=300.0K, spikes=170015
[2026-02-08T23:19:16Z INFO  nhs_rt_full]     Replica 6 complete: 5000000 spikes, T=300.0K
[2026-02-08T23:19:16Z INFO  nhs_rt_full]   Replica 7/10 (seed: 48)...
[2026-02-08T23:19:22Z INFO  prism_nhs::fused_engine] Captured 10 ensemble snapshots (avg quality: 0.63)
[2026-02-08T23:19:22Z INFO  prism_nhs::fused_engine] Step 10000: T=300.0K, spikes=167916
[2026-02-08T23:19:29Z INFO  prism_nhs::fused_engine] Captured 20 ensemble snapshots (avg quality: 0.65)
[2026-02-08T23:19:29Z INFO  prism_nhs::fused_engine] Step 20000: T=300.0K, spikes=165901
[2026-02-08T23:19:35Z INFO  prism_nhs::fused_engine] Captured 30 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:19:35Z INFO  prism_nhs::fused_engine] Step 30000: T=300.0K, spikes=163236
[2026-02-08T23:19:42Z INFO  prism_nhs::fused_engine] Captured 40 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:19:42Z INFO  prism_nhs::fused_engine] Step 40000: T=300.0K, spikes=162351
[2026-02-08T23:19:49Z INFO  prism_nhs::fused_engine] Captured 50 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:19:49Z INFO  prism_nhs::fused_engine] Step 50000: T=300.0K, spikes=161387
[2026-02-08T23:19:49Z INFO  nhs_rt_full]     Replica 7 complete: 5000000 spikes, T=300.0K
[2026-02-08T23:19:49Z INFO  nhs_rt_full]   Replica 8/10 (seed: 49)...
[2026-02-08T23:19:55Z INFO  prism_nhs::fused_engine] Captured 10 ensemble snapshots (avg quality: 0.63)
[2026-02-08T23:19:55Z INFO  prism_nhs::fused_engine] Step 10000: T=300.0K, spikes=160280
[2026-02-08T23:20:02Z INFO  prism_nhs::fused_engine] Captured 20 ensemble snapshots (avg quality: 0.65)
[2026-02-08T23:20:02Z INFO  prism_nhs::fused_engine] Step 20000: T=300.0K, spikes=159574
[2026-02-08T23:20:09Z INFO  prism_nhs::fused_engine] Captured 30 ensemble snapshots (avg quality: 0.65)
[2026-02-08T23:20:09Z INFO  prism_nhs::fused_engine] Step 30000: T=300.0K, spikes=158964
[2026-02-08T23:20:15Z INFO  prism_nhs::fused_engine] Captured 40 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:20:15Z INFO  prism_nhs::fused_engine] Step 40000: T=300.0K, spikes=158167
[2026-02-08T23:20:22Z INFO  prism_nhs::fused_engine] Captured 50 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:20:22Z INFO  prism_nhs::fused_engine] Step 50000: T=300.0K, spikes=157538
[2026-02-08T23:20:22Z INFO  nhs_rt_full]     Replica 8 complete: 5000000 spikes, T=300.0K
[2026-02-08T23:20:22Z INFO  nhs_rt_full]   Replica 9/10 (seed: 50)...
[2026-02-08T23:20:29Z INFO  prism_nhs::fused_engine] Captured 10 ensemble snapshots (avg quality: 0.63)
[2026-02-08T23:20:29Z INFO  prism_nhs::fused_engine] Step 10000: T=300.0K, spikes=156475
[2026-02-08T23:20:35Z INFO  prism_nhs::fused_engine] Captured 20 ensemble snapshots (avg quality: 0.65)
[2026-02-08T23:20:35Z INFO  prism_nhs::fused_engine] Step 20000: T=300.0K, spikes=155468
[2026-02-08T23:20:42Z INFO  prism_nhs::fused_engine] Captured 30 ensemble snapshots (avg quality: 0.65)
[2026-02-08T23:20:42Z INFO  prism_nhs::fused_engine] Step 30000: T=300.0K, spikes=154643
[2026-02-08T23:20:49Z INFO  prism_nhs::fused_engine] Captured 40 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:20:49Z INFO  prism_nhs::fused_engine] Step 40000: T=300.0K, spikes=153449
[2026-02-08T23:20:55Z INFO  prism_nhs::fused_engine] Captured 50 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:20:55Z INFO  prism_nhs::fused_engine] Step 50000: T=300.0K, spikes=151535
[2026-02-08T23:20:55Z INFO  nhs_rt_full]     Replica 9 complete: 5000000 spikes, T=300.0K
[2026-02-08T23:20:55Z INFO  nhs_rt_full]   Replica 10/10 (seed: 51)...
[2026-02-08T23:21:02Z INFO  prism_nhs::fused_engine] Captured 10 ensemble snapshots (avg quality: 0.63)
[2026-02-08T23:21:02Z INFO  prism_nhs::fused_engine] Step 10000: T=300.0K, spikes=150352
[2026-02-08T23:21:09Z INFO  prism_nhs::fused_engine] Captured 20 ensemble snapshots (avg quality: 0.65)
[2026-02-08T23:21:09Z INFO  prism_nhs::fused_engine] Step 20000: T=300.0K, spikes=149069
[2026-02-08T23:21:15Z INFO  prism_nhs::fused_engine] Captured 30 ensemble snapshots (avg quality: 0.65)
[2026-02-08T23:21:15Z INFO  prism_nhs::fused_engine] Step 30000: T=300.0K, spikes=147751
[2026-02-08T23:21:22Z INFO  prism_nhs::fused_engine] Captured 40 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:21:22Z INFO  prism_nhs::fused_engine] Step 40000: T=300.0K, spikes=147243
[2026-02-08T23:21:29Z INFO  prism_nhs::fused_engine] Captured 50 ensemble snapshots (avg quality: 0.66)
[2026-02-08T23:21:29Z INFO  prism_nhs::fused_engine] Step 50000: T=300.0K, spikes=145582
[2026-02-08T23:21:29Z INFO  nhs_rt_full]     Replica 10 complete: 5000000 spikes, T=300.0K
[2026-02-08T23:21:29Z INFO  nhs_rt_full]   âœ“ Completed in 334.5s (1495 steps/sec)
[2026-02-08T23:21:29Z INFO  nhs_rt_full]   Raw spikes collected: 50000000 (from 10 replicas)
[2026-02-08T23:21:29Z INFO  nhs_rt_full]   Snapshots: 500
[2026-02-08T23:21:29Z INFO  nhs_rt_full]   Final temperature: 300.0K
[2026-02-08T23:21:30Z INFO  nhs_rt_full]   Intensity filter: kept 1000000 spikes (top 2%, threshold=1.19)
[2026-02-08T23:21:30Z INFO  nhs_rt_full] 
    [4/6] RT-accelerated spike clustering (multi-scale)...
[2026-02-08T23:21:30Z INFO  prism_nhs::persistent_engine] Adaptive epsilon: [3.0, 5.0, 7.0, 10.0] (from k-NN analysis, k=4)
[2026-02-08T23:21:30Z INFO  prism_nhs::persistent_engine] Running multi-scale clustering on 1000000 spikes at 4 scales
[2026-02-08T23:21:30Z INFO  prism_optix::loader] OptiX: Our function table size: 480 bytes
[2026-02-08T23:21:30Z INFO  prism_optix::loader] OptiX: ABI version 118 accepted our table size (480 bytes)
[2026-02-08T23:21:30Z INFO  prism_optix::loader] OptiX function table loaded successfully (ABI version 118, table_size=480 bytes)
[2026-02-08T23:21:30Z INFO  prism_optix::context_impl] OptiX API initialized (version 90100)
[2026-02-08T23:21:30Z INFO  prism_optix::context_impl] Created OptiX context (validation: false)
[2026-02-08T23:21:30Z INFO  prism_nhs::rt_clustering] RT clustering engine created
[2026-02-08T23:21:30Z INFO  prism_nhs::rt_clustering] Loading RT clustering pipeline from: crates/prism-gpu/src/kernels/rt_clustering.optixir
[2026-02-08T23:21:30Z INFO  prism_nhs::rt_clustering] RT clustering params struct size: 88 bytes
[2026-02-08T23:21:30Z INFO  prism_nhs::rt_clustering] Phase 2 (build neighbors) pipeline created
[2026-02-08T23:21:30Z INFO  prism_nhs::rt_clustering] Loading CUDA kernels from: crates/prism-gpu/src/kernels/rt_clustering_cuda.ptx
[2026-02-08T23:21:30Z INFO  prism_nhs::rt_clustering] CUDA union-find kernels loaded
[2026-02-08T23:21:30Z INFO  prism_nhs::rt_clustering] RT clustering pipeline loaded successfully
[2026-02-08T23:21:30Z INFO  prism_optix::accel] Building BVH for 1000000 atoms using OptiX built-in spheres (allow_update=true, prefer_fast_trace=false)
[2026-02-08T23:21:30Z INFO  prism_optix::accel] âœ… BVH build complete: 1000000 spheres, handle=0x77e8ce00000c, size=86600704 bytes (82.59 MB)
[2026-02-08T23:21:46Z INFO  prism_nhs::rt_clustering] Phase 1 complete: 26232203 raw neighbor hits from 1000000 events
[2026-02-08T23:21:46Z INFO  prism_nhs::rt_clustering] Phase 2 complete: 26232203 total neighbor pairs
[2026-02-08T23:21:59Z INFO  prism_nhs::rt_clustering] Phase 3 complete: neighbor list built
[2026-02-08T23:21:59Z INFO  prism_nhs::rt_clustering] Phase 7 complete: cluster IDs assigned
[2026-02-08T23:21:59Z INFO  prism_nhs::rt_clustering] RT clustering: 1000000 events, 26232203 neighbors, 1057 clusters, 28444.87ms
[2026-02-08T23:21:59Z INFO  prism_nhs::persistent_engine]   Scale Îµ=3.0Ã…: 1057 clusters, 26232203 neighbors
[2026-02-08T23:21:59Z INFO  prism_optix::context_impl] OptiX API initialized (version 90100)
[2026-02-08T23:21:59Z INFO  prism_optix::context_impl] Created OptiX context (validation: false)
[2026-02-08T23:21:59Z INFO  prism_nhs::rt_clustering] RT clustering engine created
[2026-02-08T23:21:59Z INFO  prism_nhs::rt_clustering] Loading RT clustering pipeline from: crates/prism-gpu/src/kernels/rt_clustering.optixir
[2026-02-08T23:21:59Z INFO  prism_nhs::rt_clustering] RT clustering params struct size: 88 bytes
[2026-02-08T23:21:59Z INFO  prism_nhs::rt_clustering] Phase 2 (build neighbors) pipeline created
[2026-02-08T23:21:59Z INFO  prism_nhs::rt_clustering] Loading CUDA kernels from: crates/prism-gpu/src/kernels/rt_clustering_cuda.ptx
[2026-02-08T23:21:59Z INFO  prism_nhs::rt_clustering] CUDA union-find kernels loaded
[2026-02-08T23:21:59Z INFO  prism_nhs::rt_clustering] RT clustering pipeline loaded successfully
[2026-02-08T23:21:59Z INFO  prism_optix::accel] Building BVH for 1000000 atoms using OptiX built-in spheres (allow_update=true, prefer_fast_trace=false)
[2026-02-08T23:21:59Z INFO  prism_optix::accel] âœ… BVH build complete: 1000000 spheres, handle=0x77e8ce00000c, size=86600704 bytes (82.59 MB)
[2026-02-08T23:22:21Z INFO  prism_nhs::rt_clustering] Phase 1 complete: 29086461 raw neighbor hits from 1000000 events
[2026-02-08T23:22:21Z INFO  prism_nhs::rt_clustering] Phase 2 complete: 29086461 total neighbor pairs
[2026-02-08T23:22:44Z INFO  prism_nhs::rt_clustering] Phase 3 complete: neighbor list built
[2026-02-08T23:22:44Z INFO  prism_nhs::rt_clustering] Phase 7 complete: cluster IDs assigned
[2026-02-08T23:22:44Z INFO  prism_nhs::rt_clustering] RT clustering: 1000000 events, 29086461 neighbors, 1068 clusters, 45380.21ms
[2026-02-08T23:22:44Z INFO  prism_nhs::persistent_engine]   Scale Îµ=5.0Ã…: 1068 clusters, 29086461 neighbors
[2026-02-08T23:22:44Z INFO  prism_optix::context_impl] OptiX API initialized (version 90100)
[2026-02-08T23:22:44Z INFO  prism_optix::context_impl] Created OptiX context (validation: false)
[2026-02-08T23:22:44Z INFO  prism_nhs::rt_clustering] RT clustering engine created
[2026-02-08T23:22:44Z INFO  prism_nhs::rt_clustering] Loading RT clustering pipeline from: crates/prism-gpu/src/kernels/rt_clustering.optixir
[2026-02-08T23:22:44Z INFO  prism_nhs::rt_clustering] RT clustering params struct size: 88 bytes
[2026-02-08T23:22:44Z INFO  prism_nhs::rt_clustering] Phase 2 (build neighbors) pipeline created
[2026-02-08T23:22:44Z INFO  prism_nhs::rt_clustering] Loading CUDA kernels from: crates/prism-gpu/src/kernels/rt_clustering_cuda.ptx
[2026-02-08T23:22:44Z INFO  prism_nhs::rt_clustering] CUDA union-find kernels loaded
[2026-02-08T23:22:44Z INFO  prism_nhs::rt_clustering] RT clustering pipeline loaded successfully
[2026-02-08T23:22:44Z INFO  prism_optix::accel] Building BVH for 1000000 atoms using OptiX built-in spheres (allow_update=true, prefer_fast_trace=false)
[2026-02-08T23:22:44Z INFO  prism_optix::accel] âœ… BVH build complete: 1000000 spheres, handle=0x77e8ce00000c, size=86600704 bytes (82.59 MB)
[2026-02-08T23:24:06Z INFO  prism_nhs::rt_clustering] Phase 1 complete: 29529264 raw neighbor hits from 1000000 events
[2026-02-08T23:24:06Z INFO  prism_nhs::rt_clustering] Phase 2 complete: 29529264 total neighbor pairs
[2026-02-08T23:25:49Z INFO  prism_nhs::rt_clustering] Phase 3 complete: neighbor list built
[2026-02-08T23:25:49Z INFO  prism_nhs::rt_clustering] Phase 7 complete: cluster IDs assigned
[2026-02-08T23:25:49Z INFO  prism_nhs::rt_clustering] RT clustering: 1000000 events, 29529264 neighbors, 847 clusters, 185069.39ms
[2026-02-08T23:25:49Z INFO  prism_nhs::persistent_engine]   Scale Îµ=7.0Ã…: 847 clusters, 29529264 neighbors
[2026-02-08T23:25:49Z INFO  prism_optix::context_impl] OptiX API initialized (version 90100)
[2026-02-08T23:25:49Z INFO  prism_optix::context_impl] Created OptiX context (validation: false)
[2026-02-08T23:25:49Z INFO  prism_nhs::rt_clustering] RT clustering engine created
[2026-02-08T23:25:49Z INFO  prism_nhs::rt_clustering] Loading RT clustering pipeline from: crates/prism-gpu/src/kernels/rt_clustering.optixir
[2026-02-08T23:25:49Z INFO  prism_nhs::rt_clustering] RT clustering params struct size: 88 bytes
[2026-02-08T23:25:50Z INFO  prism_nhs::rt_clustering] Phase 2 (build neighbors) pipeline created
[2026-02-08T23:25:50Z INFO  prism_nhs::rt_clustering] Loading CUDA kernels from: crates/prism-gpu/src/kernels/rt_clustering_cuda.ptx
[2026-02-08T23:25:50Z INFO  prism_nhs::rt_clustering] CUDA union-find kernels loaded
[2026-02-08T23:25:50Z INFO  prism_nhs::rt_clustering] RT clustering pipeline loaded successfully
[2026-02-08T23:25:50Z INFO  prism_optix::accel] Building BVH for 1000000 atoms using OptiX built-in spheres (allow_update=true, prefer_fast_trace=false)
[2026-02-08T23:25:50Z INFO  prism_optix::accel] âœ… BVH build complete: 1000000 spheres, handle=0x77e8ce00000c, size=86600704 bytes (82.59 MB)
[2026-02-08T23:29:00Z INFO  prism_nhs::rt_clustering] Phase 1 complete: 27831358 raw neighbor hits from 1000000 events
[2026-02-08T23:29:00Z INFO  prism_nhs::rt_clustering] Phase 2 complete: 27831358 total neighbor pairs
[2026-02-08T23:32:11Z INFO  prism_nhs::rt_clustering] Phase 3 complete: neighbor list built
[2026-02-08T23:32:11Z INFO  prism_nhs::rt_clustering] Phase 7 complete: cluster IDs assigned
[2026-02-08T23:32:11Z INFO  prism_nhs::rt_clustering] RT clustering: 1000000 events, 27831358 neighbors, 753 clusters, 381840.03ms
[2026-02-08T23:32:11Z INFO  prism_nhs::persistent_engine]   Scale Îµ=10.0Ã…: 753 clusters, 27831358 neighbors
[2026-02-08T23:32:11Z INFO  prism_nhs::persistent_engine]   Total clusters across all scales: 5
[2026-02-08T23:32:11Z INFO  prism_nhs::persistent_engine]   Multi-scale result: 1 persistent clusters (appear at â‰¥2 scales)
[2026-02-08T23:32:11Z INFO  prism_nhs::persistent_engine]     #1: 999400 spikes, persistence=4, scales=[7.0, 3.0, 5.0, 10.0]
[2026-02-08T23:32:11Z INFO  nhs_rt_full]   âœ“ Multi-scale clustering complete: 1 persistent clusters
[2026-02-08T23:32:12Z INFO  nhs_rt_full]   Binding sites: 1 (filtered, min 50000 spikes = 2%)
[2026-02-08T23:32:12Z INFO  nhs_rt_full] 
    [5/6] Aromatic proximity analysis...
[2026-02-08T23:32:12Z INFO  nhs_rt_full]   âœ“ Analyzed 1 sites, 0 druggable
[2026-02-08T23:32:12Z INFO  nhs_rt_full]     #1: ActiveSite at (67.6, 67.7, 40.9), quality=0.67, druggable=true
[2026-02-08T23:32:12Z INFO  nhs_rt_full]         Residues (29, 3 catalytic): A:MET27, B:ARG132, B:ARG133, B:ARG136, B:ARG129, B:ARG111, A:ASN53,...
[2026-02-08T23:32:12Z INFO  nhs_rt_full]         Catalytic: A:HIS23 (6.1Ã…), A:HIS24 (6.9Ã…), A:HIS25 (7.1Ã…)
[2026-02-08T23:32:12Z INFO  nhs_rt_full] 
    [6/6] Generating visualization output...
[2026-02-08T23:32:12Z INFO  prism_nhs::persistent_engine] Wrote binding sites PDB: e2e_validation_test/results_myc_dimer/1nkp_single/1nkp_dimer.binding_sites.pdb
[2026-02-08T23:32:12Z INFO  prism_nhs::persistent_engine] Wrote PyMOL script: e2e_validation_test/results_myc_dimer/1nkp_single/1nkp_dimer.binding_sites.pml
[2026-02-08T23:32:12Z INFO  prism_nhs::persistent_engine] Wrote ChimeraX script: e2e_validation_test/results_myc_dimer/1nkp_single/1nkp_dimer.binding_sites.cxc
[2026-02-08T23:32:12Z INFO  prism_nhs::persistent_engine] Wrote Markdown report: e2e_validation_test/results_myc_dimer/1nkp_single/1nkp_dimer.binding_sites.md
[2026-02-08T23:32:12Z INFO  nhs_rt_full]   âœ“ JSON summary: e2e_validation_test/results_myc_dimer/1nkp_single/1nkp_dimer.binding_sites.json
[2026-02-08T23:32:30Z INFO  nhs_rt_full]   âœ“ Ensemble trajectory: e2e_validation_test/results_myc_dimer/1nkp_single/1nkp_dimer.ensemble_trajectory.pdb (500 models, 2879 atoms each, 117.5 MB)
[2026-02-08T23:32:30Z INFO  nhs_rt_full] 
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
[2026-02-08T23:32:30Z INFO  nhs_rt_full] â•‘  PIPELINE COMPLETE                                            â•‘
[2026-02-08T23:32:30Z INFO  nhs_rt_full] â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
[2026-02-08T23:32:30Z INFO  nhs_rt_full] â•‘  Structure: 1nkp_dimer.topology                              â•‘
[2026-02-08T23:32:30Z INFO  nhs_rt_full] â•‘  Total time: 996.2                                         s â•‘
[2026-02-08T23:32:30Z INFO  nhs_rt_full] â•‘  Spikes detected: 1000000                                   â•‘
[2026-02-08T23:32:30Z INFO  nhs_rt_full] â•‘  Binding sites: 1                                           â•‘
[2026-02-08T23:32:30Z INFO  nhs_rt_full] â•‘  Druggable sites: 1                                         â•‘
[2026-02-08T23:32:30Z INFO  nhs_rt_full] â•‘  RT cores used: Yes                                         â•‘
[2026-02-08T23:32:30Z INFO  nhs_rt_full] â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
