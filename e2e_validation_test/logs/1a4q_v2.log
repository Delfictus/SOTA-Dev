[2026-02-05T08:48:43Z INFO  nhs_rt_full] â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
[2026-02-05T08:48:43Z INFO  nhs_rt_full] â•‘     PRISM4D NHS RT-FULL PIPELINE                              â•‘
[2026-02-05T08:48:43Z INFO  nhs_rt_full] â•‘     RT-Core Accelerated Binding Site Detection                â•‘
[2026-02-05T08:48:43Z INFO  nhs_rt_full] â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-02-05T08:48:43Z INFO  nhs_rt_full] 
    [1/6] Loading topology: /home/diddy/Desktop/Prism4D-bio/e2e_validation_test/prep/1a4q.topology.json
[2026-02-05T08:48:43Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: /home/diddy/Desktop/Prism4D-bio/e2e_validation_test/prep/1a4q.topology.json
[2026-02-05T08:48:43Z INFO  prism_nhs::input] Loaded topology: 11926 atoms, 780 residues, 2 chains
[2026-02-05T08:48:43Z INFO  nhs_rt_full]   Atoms: 11926
[2026-02-05T08:48:43Z INFO  nhs_rt_full]   Residues: 780
[2026-02-05T08:48:43Z INFO  nhs_rt_full]   Aromatics: 11 (TRP/TYR/PHE)
[2026-02-05T08:48:43Z INFO  nhs_rt_full] 
    [2/6] Initializing GPU engine...
[2026-02-05T08:48:43Z INFO  prism_nhs::persistent_engine] ğŸš€ Initializing Persistent NHS Engine (max_atoms: 15000)
[2026-02-05T08:48:43Z INFO  prism_nhs::persistent_engine]   CUDA context: 115ms
[2026-02-05T08:48:43Z INFO  prism_nhs::persistent_engine]   PTX module: 3ms
[2026-02-05T08:48:43Z INFO  prism_nhs::persistent_engine] âœ… Persistent engine ready (total init: 118ms)
[2026-02-05T08:48:43Z INFO  prism_nhs::persistent_engine] ğŸ“¦ Loading topology: 1a4q_sanitized (11926 atoms)
[2026-02-05T08:48:43Z INFO  prism_nhs::fused_engine] Creating NHS-AMBER Fused Engine: 11926 atoms, grid 64Â³
[2026-02-05T08:48:43Z INFO  prism_nhs::fused_engine] Loaded fused kernel PTX from: crates/prism-gpu/src/kernels/nhs_amber_fused.ptx
[2026-02-05T08:48:43Z INFO  prism_nhs::fused_engine] Cell grid: 10x9x11 = 990 cells (cell size 10 Ã…)
[2026-02-05T08:48:43Z INFO  prism_nhs::fused_engine] Neighbor list mode: ENABLED (O(N)) (n_atoms=11926)
[2026-02-05T08:48:43Z INFO  prism_nhs::fused_engine] Uploaded aromatic topology: 74 aromatics with ring atom indices
[2026-02-05T08:48:43Z INFO  prism_nhs::fused_engine] Uploaded topology: 12088 bonds, 21778 angles, 40984 dihedrals
[2026-02-05T08:48:43Z INFO  prism_nhs::fused_engine] Excited state: 74 aromatics mapped
[2026-02-05T08:48:44Z INFO  prism_nhs::fused_engine] Built warp matrix: 262144 voxels (76359 with atoms, avg 4.1 atoms/voxel, max 16)
[2026-02-05T08:48:44Z INFO  prism_nhs::fused_engine] Built aromatic neighbor lists for 74 aromatics (cutoff 5.0A)
[2026-02-05T08:48:44Z INFO  prism_nhs::fused_engine] Computed ring normals for 74 aromatics
[2026-02-05T08:48:44Z INFO  prism_nhs::fused_engine] Computed and uploaded aromatic centroids for 74 aromatics
[2026-02-05T08:48:44Z INFO  prism_nhs::fused_engine] NHS-AMBER Fused Engine created successfully
[2026-02-05T08:48:44Z INFO  prism_nhs::fused_engine]   Bonds: 12088, Angles: 21778, Dihedrals: 40984
[2026-02-05T08:48:44Z INFO  prism_nhs::fused_engine]   H-Clusters (SHAKE): 3832
[2026-02-05T08:48:44Z INFO  prism_nhs::fused_engine]   UV Targets: 74
[2026-02-05T08:48:44Z INFO  prism_nhs::fused_engine]   Cryogenic physics: ENABLED
[2026-02-05T08:48:44Z INFO  prism_nhs::persistent_engine]   Topology loaded: 1737ms
[2026-02-05T08:48:44Z INFO  nhs_rt_full]   RT-core clustering: âœ“ Available
[2026-02-05T08:48:44Z INFO  nhs_rt_full]   Protocol: Fast 50K (60% faster, full aromatic coverage)
[2026-02-05T08:48:44Z INFO  prism_nhs::fused_engine] â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
[2026-02-05T08:48:44Z INFO  prism_nhs::fused_engine] â•‘  UNIFIED CRYO-UV PROTOCOL ACTIVATED                           â•‘
[2026-02-05T08:48:44Z INFO  prism_nhs::fused_engine] â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-02-05T08:48:44Z INFO  prism_nhs::fused_engine]   Temperature: 50K â†’ 300K
[2026-02-05T08:48:44Z INFO  prism_nhs::fused_engine]   Phases: cold_hold=20000, ramp=8000, warm_hold=2000
[2026-02-05T08:48:44Z INFO  prism_nhs::fused_engine]   UV bursts: 30kcal/mol every 400 steps (50 step duration)
[2026-02-05T08:48:44Z INFO  prism_nhs::fused_engine]   Wavelengths: [280.0, 274.0, 258.0, 211.0] nm
[2026-02-05T08:48:44Z INFO  prism_nhs::fused_engine]   âœ“ UV-LIF coupling: ACTIVE (100% aromatic localization)
[2026-02-05T08:48:44Z INFO  prism_nhs::fused_engine] Spike accumulation: ENABLED
[2026-02-05T08:48:44Z INFO  prism_nhs::fused_engine] Enabling hyperoptimized ultimate kernel mode...
[2026-02-05T08:48:44Z INFO  prism_nhs::ultimate_engine] Creating Ultimate Hyperoptimized Engine: 11926 atoms
[2026-02-05T08:48:44Z INFO  prism_nhs::ultimate_engine] Loaded ultimate_md.ptx from: crates/prism-gpu/src/kernels/ultimate_md.ptx
[2026-02-05T08:48:44Z INFO  prism_nhs::fused_engine] Ultimate mode enabled: SoA layout, occupancy tuning, all 14 optimizations active
[2026-02-05T08:48:44Z INFO  prism_nhs::persistent_engine] âœ“ UltimateEngine enabled (2-4x faster MD)
[2026-02-05T08:48:44Z INFO  nhs_rt_full]   UltimateEngine: âœ“ Enabled (2-4x faster MD)
[2026-02-05T08:48:44Z INFO  nhs_rt_full] 
    [3/6] Running MD simulation (50000 steps x 3 replicas)...
[2026-02-05T08:48:44Z INFO  nhs_rt_full]   Mode: PARALLEL (AmberSimdBatch, 3 replicas simultaneous)
[2026-02-05T08:48:44Z INFO  prism_nhs::parallel_replica] Creating ParallelReplicaEngine: 3 replicas Ã— 11926 atoms
[2026-02-05T08:48:44Z INFO  prism_gpu::amber_simd_batch] AmberSimdBatch initialized: max 3 structures Ã— 11926 atoms
[2026-02-05T08:48:44Z INFO  prism_nhs::parallel_replica]   Aromatic atoms for UV bursts: 1578
[2026-02-05T08:48:44Z INFO  prism_nhs::parallel_replica] Finalizing parallel replica batch (uploading to GPU)...
[2026-02-05T08:48:44Z INFO  prism_gpu::h_constraints] ğŸ”— HConstraints: 11496 clusters (6720 single, 3486 CH2/NH2, 1290 CH3/NH3)
[2026-02-05T08:48:44Z INFO  prism_gpu::amber_simd_batch] H-constraints: 11496 clusters (17562 total constraints, DOF adjusted)
[2026-02-05T08:48:44Z INFO  prism_gpu::amber_simd_batch] SOTA optimizations enabled:
[2026-02-05T08:48:44Z INFO  prism_gpu::amber_simd_batch]   - Verlet list: NO
[2026-02-05T08:48:44Z INFO  prism_gpu::amber_simd_batch]   - Tensor Cores: NO
[2026-02-05T08:48:44Z INFO  prism_gpu::amber_simd_batch]   - FP16 params: NO
[2026-02-05T08:48:44Z INFO  prism_gpu::amber_simd_batch]   - Async pipeline: NO
[2026-02-05T08:48:44Z INFO  prism_gpu::amber_simd_batch]   - Batched forces: NO
[2026-02-05T08:48:44Z INFO  prism_gpu::amber_simd_batch] Batch finalized: 3 structures, 35778 atoms
[2026-02-05T08:48:44Z INFO  prism_nhs::parallel_replica]   âœ“ Batch finalized: 3 replicas ready
[2026-02-05T08:48:44Z INFO  prism_nhs::parallel_replica] Running parallel replicas: 50000 steps Ã— 3 replicas
[2026-02-05T08:48:44Z INFO  prism_nhs::parallel_replica]   Protocol phases: cold=20000, ramp=8000, warm=22000
[2026-02-05T08:48:44Z INFO  prism_nhs::parallel_replica]   [1/3] Cold hold at 50K (20000 steps)...
[2026-02-05T08:48:44Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 3 structures, 35778 atoms, 500 steps
[2026-02-05T08:48:44Z INFO  prism_gpu::amber_simd_batch] Using legacy path (SOTA disabled for debugging)
[2026-02-05T08:50:11Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD complete: 500 steps
[2026-02-05T08:50:11Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 3 structures, 35778 atoms, 500 steps
[2026-02-05T08:50:11Z INFO  prism_gpu::amber_simd_batch] Using legacy path (SOTA disabled for debugging)
[2026-02-05T08:51:41Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD complete: 500 steps
[2026-02-05T08:51:41Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 3 structures, 35778 atoms, 500 steps
[2026-02-05T08:51:41Z INFO  prism_gpu::amber_simd_batch] Using legacy path (SOTA disabled for debugging)
[2026-02-05T08:53:13Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD complete: 500 steps
[2026-02-05T08:53:13Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 3 structures, 35778 atoms, 500 steps
[2026-02-05T08:53:13Z INFO  prism_gpu::amber_simd_batch] Using legacy path (SOTA disabled for debugging)
[2026-02-05T08:54:43Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD complete: 500 steps
[2026-02-05T08:54:43Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 3 structures, 35778 atoms, 500 steps
[2026-02-05T08:54:43Z INFO  prism_gpu::amber_simd_batch] Using legacy path (SOTA disabled for debugging)
[2026-02-05T08:56:14Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD complete: 500 steps
[2026-02-05T08:56:14Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 3 structures, 35778 atoms, 500 steps
[2026-02-05T08:56:14Z INFO  prism_gpu::amber_simd_batch] Using legacy path (SOTA disabled for debugging)
[2026-02-05T08:57:47Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD complete: 500 steps
[2026-02-05T08:57:47Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 3 structures, 35778 atoms, 500 steps
[2026-02-05T08:57:47Z INFO  prism_gpu::amber_simd_batch] Using legacy path (SOTA disabled for debugging)
[2026-02-05T08:59:21Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD complete: 500 steps
[2026-02-05T08:59:21Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 3 structures, 35778 atoms, 500 steps
[2026-02-05T08:59:21Z INFO  prism_gpu::amber_simd_batch] Using legacy path (SOTA disabled for debugging)
