[2026-02-05T08:59:34Z INFO  nhs_rt_full] â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
[2026-02-05T08:59:34Z INFO  nhs_rt_full] â•‘     PRISM4D NHS RT-FULL PIPELINE                              â•‘
[2026-02-05T08:59:34Z INFO  nhs_rt_full] â•‘     RT-Core Accelerated Binding Site Detection                â•‘
[2026-02-05T08:59:34Z INFO  nhs_rt_full] â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-02-05T08:59:34Z INFO  nhs_rt_full] 
    [1/6] Loading topology: /home/diddy/Desktop/Prism4D-bio/e2e_validation_test/prep/1ade.topology.json
[2026-02-05T08:59:34Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: /home/diddy/Desktop/Prism4D-bio/e2e_validation_test/prep/1ade.topology.json
[2026-02-05T08:59:34Z INFO  prism_nhs::input] Loaded topology: 13294 atoms, 862 residues, 2 chains
[2026-02-05T08:59:34Z INFO  nhs_rt_full]   Atoms: 13294
[2026-02-05T08:59:34Z INFO  nhs_rt_full]   Residues: 862
[2026-02-05T08:59:34Z INFO  nhs_rt_full]   Aromatics: 4 (TRP/TYR/PHE)
[2026-02-05T08:59:34Z INFO  nhs_rt_full] 
    [2/6] Initializing GPU engine...
[2026-02-05T08:59:34Z INFO  prism_nhs::persistent_engine] ğŸš€ Initializing Persistent NHS Engine (max_atoms: 15000)
[2026-02-05T08:59:34Z INFO  prism_nhs::persistent_engine]   CUDA context: 110ms
[2026-02-05T08:59:34Z INFO  prism_nhs::persistent_engine]   PTX module: 2ms
[2026-02-05T08:59:34Z INFO  prism_nhs::persistent_engine] âœ… Persistent engine ready (total init: 112ms)
[2026-02-05T08:59:34Z INFO  prism_nhs::persistent_engine] ğŸ“¦ Loading topology: 1ade_sanitized (13294 atoms)
[2026-02-05T08:59:34Z INFO  prism_nhs::fused_engine] Creating NHS-AMBER Fused Engine: 13294 atoms, grid 64Â³
[2026-02-05T08:59:34Z INFO  prism_nhs::fused_engine] Loaded fused kernel PTX from: crates/prism-gpu/src/kernels/nhs_amber_fused.ptx
[2026-02-05T08:59:34Z INFO  prism_nhs::fused_engine] Cell grid: 10x9x11 = 990 cells (cell size 10 Ã…)
[2026-02-05T08:59:34Z INFO  prism_nhs::fused_engine] Neighbor list mode: ENABLED (O(N)) (n_atoms=13294)
[2026-02-05T08:59:34Z INFO  prism_nhs::fused_engine] Uploaded aromatic topology: 64 aromatics with ring atom indices
[2026-02-05T08:59:34Z INFO  prism_nhs::fused_engine] Uploaded topology: 13410 bonds, 24270 angles, 45316 dihedrals
[2026-02-05T08:59:34Z INFO  prism_nhs::fused_engine] Excited state: 64 aromatics mapped
[2026-02-05T08:59:36Z INFO  prism_nhs::fused_engine] Built warp matrix: 262144 voxels (85353 with atoms, avg 4.6 atoms/voxel, max 16)
[2026-02-05T08:59:36Z INFO  prism_nhs::fused_engine] Built aromatic neighbor lists for 64 aromatics (cutoff 5.0A)
[2026-02-05T08:59:36Z INFO  prism_nhs::fused_engine] Computed ring normals for 64 aromatics
[2026-02-05T08:59:36Z INFO  prism_nhs::fused_engine] Computed and uploaded aromatic centroids for 64 aromatics
[2026-02-05T08:59:36Z INFO  prism_nhs::fused_engine] NHS-AMBER Fused Engine created successfully
[2026-02-05T08:59:36Z INFO  prism_nhs::fused_engine]   Bonds: 13410, Angles: 24270, Dihedrals: 45316
[2026-02-05T08:59:36Z INFO  prism_nhs::fused_engine]   H-Clusters (SHAKE): 4220
[2026-02-05T08:59:36Z INFO  prism_nhs::fused_engine]   UV Targets: 64
[2026-02-05T08:59:36Z INFO  prism_nhs::fused_engine]   Cryogenic physics: ENABLED
[2026-02-05T08:59:36Z INFO  prism_nhs::persistent_engine]   Topology loaded: 1908ms
[2026-02-05T08:59:36Z INFO  nhs_rt_full]   RT-core clustering: âœ“ Available
[2026-02-05T08:59:36Z INFO  nhs_rt_full]   Protocol: Fast 50K (60% faster, full aromatic coverage)
[2026-02-05T08:59:36Z INFO  prism_nhs::fused_engine] â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
[2026-02-05T08:59:36Z INFO  prism_nhs::fused_engine] â•‘  UNIFIED CRYO-UV PROTOCOL ACTIVATED                           â•‘
[2026-02-05T08:59:36Z INFO  prism_nhs::fused_engine] â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-02-05T08:59:36Z INFO  prism_nhs::fused_engine]   Temperature: 50K â†’ 300K
[2026-02-05T08:59:36Z INFO  prism_nhs::fused_engine]   Phases: cold_hold=20000, ramp=8000, warm_hold=2000
[2026-02-05T08:59:36Z INFO  prism_nhs::fused_engine]   UV bursts: 30kcal/mol every 400 steps (50 step duration)
[2026-02-05T08:59:36Z INFO  prism_nhs::fused_engine]   Wavelengths: [280.0, 274.0, 258.0, 211.0] nm
[2026-02-05T08:59:36Z INFO  prism_nhs::fused_engine]   âœ“ UV-LIF coupling: ACTIVE (100% aromatic localization)
[2026-02-05T08:59:36Z INFO  prism_nhs::fused_engine] Spike accumulation: ENABLED
[2026-02-05T08:59:36Z INFO  prism_nhs::fused_engine] Enabling hyperoptimized ultimate kernel mode...
[2026-02-05T08:59:36Z INFO  prism_nhs::ultimate_engine] Creating Ultimate Hyperoptimized Engine: 13294 atoms
[2026-02-05T08:59:36Z INFO  prism_nhs::ultimate_engine] Loaded ultimate_md.ptx from: crates/prism-gpu/src/kernels/ultimate_md.ptx
[2026-02-05T08:59:36Z INFO  prism_nhs::fused_engine] Ultimate mode enabled: SoA layout, occupancy tuning, all 14 optimizations active
[2026-02-05T08:59:36Z INFO  prism_nhs::persistent_engine] âœ“ UltimateEngine enabled (2-4x faster MD)
[2026-02-05T08:59:36Z INFO  nhs_rt_full]   UltimateEngine: âœ“ Enabled (2-4x faster MD)
[2026-02-05T08:59:36Z INFO  nhs_rt_full] 
    [3/6] Running MD simulation (50000 steps x 3 replicas)...
[2026-02-05T08:59:36Z INFO  nhs_rt_full]   Mode: PARALLEL (AmberSimdBatch, 3 replicas simultaneous)
[2026-02-05T08:59:36Z INFO  prism_nhs::parallel_replica] Creating ParallelReplicaEngine: 3 replicas Ã— 13294 atoms
[2026-02-05T08:59:36Z INFO  prism_gpu::amber_simd_batch] AmberSimdBatch initialized: max 3 structures Ã— 13294 atoms
[2026-02-05T08:59:36Z INFO  prism_nhs::parallel_replica]   Aromatic atoms for UV bursts: 1344
[2026-02-05T08:59:36Z INFO  prism_nhs::parallel_replica] Finalizing parallel replica batch (uploading to GPU)...
[2026-02-05T08:59:36Z INFO  prism_gpu::h_constraints] ğŸ”— HConstraints: 12660 clusters (7182 single, 3660 CH2/NH2, 1818 CH3/NH3)
[2026-02-05T08:59:36Z INFO  prism_gpu::amber_simd_batch] H-constraints: 12660 clusters (19956 total constraints, DOF adjusted)
[2026-02-05T08:59:36Z INFO  prism_gpu::amber_simd_batch] SOTA optimizations enabled:
[2026-02-05T08:59:36Z INFO  prism_gpu::amber_simd_batch]   - Verlet list: NO
[2026-02-05T08:59:36Z INFO  prism_gpu::amber_simd_batch]   - Tensor Cores: NO
[2026-02-05T08:59:36Z INFO  prism_gpu::amber_simd_batch]   - FP16 params: NO
[2026-02-05T08:59:36Z INFO  prism_gpu::amber_simd_batch]   - Async pipeline: NO
[2026-02-05T08:59:36Z INFO  prism_gpu::amber_simd_batch]   - Batched forces: NO
[2026-02-05T08:59:36Z INFO  prism_gpu::amber_simd_batch] Batch finalized: 3 structures, 39882 atoms
[2026-02-05T08:59:36Z INFO  prism_nhs::parallel_replica]   âœ“ Batch finalized: 3 replicas ready
[2026-02-05T08:59:36Z INFO  prism_nhs::parallel_replica] Running parallel replicas: 50000 steps Ã— 3 replicas
[2026-02-05T08:59:36Z INFO  prism_nhs::parallel_replica]   Protocol phases: cold=20000, ramp=8000, warm=22000
[2026-02-05T08:59:36Z INFO  prism_nhs::parallel_replica]   [1/3] Cold hold at 50K (20000 steps)...
[2026-02-05T08:59:36Z INFO  prism_gpu::amber_simd_batch] SIMD batch MD: 3 structures, 39882 atoms, 500 steps
[2026-02-05T08:59:36Z INFO  prism_gpu::amber_simd_batch] Using legacy path (SOTA disabled for debugging)
