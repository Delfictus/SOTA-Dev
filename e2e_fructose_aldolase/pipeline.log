[2026-02-04T21:01:36Z INFO  nhs_rt_full] â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
[2026-02-04T21:01:36Z INFO  nhs_rt_full] â•‘     PRISM4D NHS RT-FULL PIPELINE                              â•‘
[2026-02-04T21:01:36Z INFO  nhs_rt_full] â•‘     RT-Core Accelerated Binding Site Detection                â•‘
[2026-02-04T21:01:36Z INFO  nhs_rt_full] â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-02-04T21:01:36Z INFO  nhs_rt_full] 
    [1/6] Loading topology: production_test/targets/07_FructoseAldolase_apo.topology.json
[2026-02-04T21:01:36Z INFO  prism_nhs::input] Loading PRISM-PREP topology from: production_test/targets/07_FructoseAldolase_apo.topology.json
[2026-02-04T21:01:36Z INFO  prism_nhs::input] Loaded topology: 22124 atoms, 1452 residues, 4 chains
[2026-02-04T21:01:36Z INFO  nhs_rt_full]   Atoms: 22124
[2026-02-04T21:01:36Z INFO  nhs_rt_full]   Residues: 1452
[2026-02-04T21:01:36Z INFO  nhs_rt_full]   Aromatics: 8 (TRP/TYR/PHE)
[2026-02-04T21:01:36Z INFO  nhs_rt_full] 
    [2/6] Initializing GPU engine...
[2026-02-04T21:01:36Z INFO  prism_nhs::persistent_engine] ğŸš€ Initializing Persistent NHS Engine (max_atoms: 22124)
[2026-02-04T21:01:36Z INFO  prism_nhs::persistent_engine]   CUDA context: 116ms
[2026-02-04T21:01:36Z INFO  prism_nhs::persistent_engine]   PTX module: 3ms
[2026-02-04T21:01:36Z INFO  prism_nhs::persistent_engine] âœ… Persistent engine ready (total init: 119ms)
[2026-02-04T21:01:36Z INFO  prism_nhs::persistent_engine] ğŸ“¦ Loading topology: 07_FructoseAldolase_apo_sanitized (22124 atoms)
[2026-02-04T21:01:36Z INFO  prism_nhs::fused_engine] Creating NHS-AMBER Fused Engine: 22124 atoms, grid 64Â³
[2026-02-04T21:01:36Z INFO  prism_nhs::fused_engine] Loaded fused kernel PTX from: crates/prism-gpu/src/kernels/nhs_amber_fused.ptx
[2026-02-04T21:01:36Z INFO  prism_nhs::fused_engine] Cell grid: 12x11x12 = 1584 cells (cell size 10 Ã…)
[2026-02-04T21:01:36Z INFO  prism_nhs::fused_engine] Neighbor list mode: ENABLED (O(N)) (n_atoms=22124)
[2026-02-04T21:01:36Z INFO  prism_nhs::fused_engine] Uploaded aromatic topology: 88 aromatics with ring atom indices
[2026-02-04T21:01:36Z INFO  prism_nhs::fused_engine] Uploaded topology: 22336 bonds, 40512 angles, 76012 dihedrals
[2026-02-04T21:01:36Z INFO  prism_nhs::fused_engine] Excited state: 88 aromatics mapped
[2026-02-04T21:01:39Z INFO  prism_nhs::fused_engine] Built warp matrix: 262144 voxels (134820 with atoms, avg 7.3 atoms/voxel, max 16)
[2026-02-04T21:01:39Z INFO  prism_nhs::fused_engine] Built aromatic neighbor lists for 88 aromatics (cutoff 5.0A)
[2026-02-04T21:01:39Z INFO  prism_nhs::fused_engine] Computed ring normals for 88 aromatics
[2026-02-04T21:01:39Z INFO  prism_nhs::fused_engine] Computed and uploaded aromatic centroids for 88 aromatics
[2026-02-04T21:01:39Z INFO  prism_nhs::fused_engine] NHS-AMBER Fused Engine created successfully
[2026-02-04T21:01:39Z INFO  prism_nhs::fused_engine]   Bonds: 22336, Angles: 40512, Dihedrals: 76012
[2026-02-04T21:01:39Z INFO  prism_nhs::fused_engine]   H-Clusters (SHAKE): 7036
[2026-02-04T21:01:39Z INFO  prism_nhs::fused_engine]   UV Targets: 88
[2026-02-04T21:01:39Z INFO  prism_nhs::fused_engine]   Cryogenic physics: ENABLED
[2026-02-04T21:01:39Z INFO  prism_nhs::persistent_engine]   Topology loaded: 3083ms
[2026-02-04T21:01:39Z INFO  nhs_rt_full]   RT-core clustering: âœ“ Available
[2026-02-04T21:01:39Z INFO  prism_nhs::fused_engine] â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
[2026-02-04T21:01:39Z INFO  prism_nhs::fused_engine] â•‘  UNIFIED CRYO-UV PROTOCOL ACTIVATED                           â•‘
[2026-02-04T21:01:39Z INFO  prism_nhs::fused_engine] â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-02-04T21:01:39Z INFO  prism_nhs::fused_engine]   Temperature: 100K â†’ 300K
[2026-02-04T21:01:39Z INFO  prism_nhs::fused_engine]   Phases: cold_hold=50000, ramp=6875, warm_hold=6875
[2026-02-04T21:01:39Z INFO  prism_nhs::fused_engine]   UV bursts: 30kcal/mol every 500 steps (50 step duration)
[2026-02-04T21:01:39Z INFO  prism_nhs::fused_engine]   Wavelengths: [280.0, 274.0, 258.0] nm
[2026-02-04T21:01:39Z INFO  prism_nhs::fused_engine]   âœ“ UV-LIF coupling: ACTIVE (100% aromatic localization)
[2026-02-04T21:01:39Z INFO  prism_nhs::fused_engine] Spike accumulation: ENABLED
[2026-02-04T21:01:39Z INFO  prism_nhs::fused_engine] Enabling hyperoptimized ultimate kernel mode...
[2026-02-04T21:01:39Z INFO  prism_nhs::ultimate_engine] Creating Ultimate Hyperoptimized Engine: 22124 atoms
[2026-02-04T21:01:39Z INFO  prism_nhs::ultimate_engine] Loaded ultimate_md.ptx from: crates/prism-gpu/src/kernels/ultimate_md.ptx
[2026-02-04T21:01:39Z INFO  prism_nhs::fused_engine] Ultimate mode enabled: SoA layout, occupancy tuning, all 14 optimizations active
[2026-02-04T21:01:39Z INFO  prism_nhs::persistent_engine] âœ“ UltimateEngine enabled (2-4x faster MD)
[2026-02-04T21:01:39Z INFO  nhs_rt_full]   UltimateEngine: âœ“ Enabled (2-4x faster MD)
[2026-02-04T21:01:39Z INFO  nhs_rt_full] 
    [3/6] Running MD simulation (55000 steps x 4 replicas)...
[2026-02-04T21:01:39Z INFO  nhs_rt_full]   Replica 1/4 (seed: 42)...
[2026-02-04T21:01:54Z INFO  prism_nhs::fused_engine] Captured 10 ensemble snapshots (avg quality: 0.62)
[2026-02-04T21:01:54Z INFO  prism_nhs::fused_engine] Step 10000: T=300.0K, spikes=3546460
[2026-02-04T21:02:06Z INFO  prism_nhs::fused_engine] Captured 20 ensemble snapshots (avg quality: 0.65)
[2026-02-04T21:02:06Z INFO  prism_nhs::fused_engine] Step 20000: T=300.0K, spikes=3510073
[2026-02-04T21:02:19Z INFO  prism_nhs::fused_engine] Captured 30 ensemble snapshots (avg quality: 0.66)
[2026-02-04T21:02:19Z INFO  prism_nhs::fused_engine] Step 30000: T=300.0K, spikes=3472767
[2026-02-04T21:02:31Z INFO  prism_nhs::fused_engine] Captured 40 ensemble snapshots (avg quality: 0.67)
[2026-02-04T21:02:31Z INFO  prism_nhs::fused_engine] Step 40000: T=300.0K, spikes=3426726
[2026-02-04T21:02:44Z INFO  prism_nhs::fused_engine] Captured 50 ensemble snapshots (avg quality: 0.67)
[2026-02-04T21:02:44Z INFO  prism_nhs::fused_engine] Step 50000: T=300.0K, spikes=3378836
[2026-02-04T21:02:50Z INFO  nhs_rt_full]     Replica 1 complete: 5500000 spikes, T=300.0K
[2026-02-04T21:02:50Z INFO  nhs_rt_full]   Replica 2/4 (seed: 43)...
[2026-02-04T21:03:03Z INFO  prism_nhs::fused_engine] Captured 10 ensemble snapshots (avg quality: 0.64)
[2026-02-04T21:03:03Z INFO  prism_nhs::fused_engine] Step 10000: T=300.0K, spikes=3311369
[2026-02-04T21:03:15Z INFO  prism_nhs::fused_engine] Captured 20 ensemble snapshots (avg quality: 0.66)
[2026-02-04T21:03:15Z INFO  prism_nhs::fused_engine] Step 20000: T=300.0K, spikes=3267400
[2026-02-04T21:03:27Z INFO  prism_nhs::fused_engine] Captured 30 ensemble snapshots (avg quality: 0.67)
[2026-02-04T21:03:27Z INFO  prism_nhs::fused_engine] Step 30000: T=300.0K, spikes=3227339
[2026-02-04T21:03:40Z INFO  prism_nhs::fused_engine] Captured 40 ensemble snapshots (avg quality: 0.67)
[2026-02-04T21:03:40Z INFO  prism_nhs::fused_engine] Step 40000: T=300.0K, spikes=3191407
[2026-02-04T21:03:52Z INFO  prism_nhs::fused_engine] Captured 50 ensemble snapshots (avg quality: 0.67)
[2026-02-04T21:03:52Z INFO  prism_nhs::fused_engine] Step 50000: T=300.0K, spikes=3157263
[2026-02-04T21:03:59Z INFO  nhs_rt_full]     Replica 2 complete: 5500000 spikes, T=300.0K
[2026-02-04T21:03:59Z INFO  nhs_rt_full]   Replica 3/4 (seed: 44)...
[2026-02-04T21:04:11Z INFO  prism_nhs::fused_engine] Captured 10 ensemble snapshots (avg quality: 0.63)
[2026-02-04T21:04:11Z INFO  prism_nhs::fused_engine] Step 10000: T=300.0K, spikes=3100888
[2026-02-04T21:04:24Z INFO  prism_nhs::fused_engine] Captured 20 ensemble snapshots (avg quality: 0.66)
[2026-02-04T21:04:24Z INFO  prism_nhs::fused_engine] Step 20000: T=300.0K, spikes=3063066
[2026-02-04T21:04:36Z INFO  prism_nhs::fused_engine] Captured 30 ensemble snapshots (avg quality: 0.66)
[2026-02-04T21:04:36Z INFO  prism_nhs::fused_engine] Step 30000: T=300.0K, spikes=3025371
[2026-02-04T21:04:49Z INFO  prism_nhs::fused_engine] Captured 40 ensemble snapshots (avg quality: 0.67)
[2026-02-04T21:04:49Z INFO  prism_nhs::fused_engine] Step 40000: T=300.0K, spikes=2983578
[2026-02-04T21:05:02Z INFO  prism_nhs::fused_engine] Captured 50 ensemble snapshots (avg quality: 0.67)
[2026-02-04T21:05:02Z INFO  prism_nhs::fused_engine] Step 50000: T=300.0K, spikes=2939449
[2026-02-04T21:05:08Z INFO  nhs_rt_full]     Replica 3 complete: 5500000 spikes, T=300.0K
[2026-02-04T21:05:08Z INFO  nhs_rt_full]   Replica 4/4 (seed: 45)...
[2026-02-04T21:05:21Z INFO  prism_nhs::fused_engine] Captured 10 ensemble snapshots (avg quality: 0.63)
[2026-02-04T21:05:21Z INFO  prism_nhs::fused_engine] Step 10000: T=300.0K, spikes=2890305
[2026-02-04T21:05:33Z INFO  prism_nhs::fused_engine] Captured 20 ensemble snapshots (avg quality: 0.65)
[2026-02-04T21:05:33Z INFO  prism_nhs::fused_engine] Step 20000: T=300.0K, spikes=2862849
[2026-02-04T21:05:46Z INFO  prism_nhs::fused_engine] Captured 30 ensemble snapshots (avg quality: 0.66)
[2026-02-04T21:05:46Z INFO  prism_nhs::fused_engine] Step 30000: T=300.0K, spikes=2835018
[2026-02-04T21:05:58Z INFO  prism_nhs::fused_engine] Captured 40 ensemble snapshots (avg quality: 0.67)
[2026-02-04T21:05:58Z INFO  prism_nhs::fused_engine] Step 40000: T=300.0K, spikes=2809877
[2026-02-04T21:06:11Z INFO  prism_nhs::fused_engine] Captured 50 ensemble snapshots (avg quality: 0.67)
[2026-02-04T21:06:11Z INFO  prism_nhs::fused_engine] Step 50000: T=300.0K, spikes=2786938
[2026-02-04T21:06:18Z INFO  nhs_rt_full]     Replica 4 complete: 5500000 spikes, T=300.0K
[2026-02-04T21:06:18Z INFO  nhs_rt_full]   âœ“ Completed in 278.4s (790 steps/sec)
[2026-02-04T21:06:18Z INFO  nhs_rt_full]   Raw spikes collected: 22000000 (from 4 replicas)
[2026-02-04T21:06:18Z INFO  nhs_rt_full]   Snapshots: 220
[2026-02-04T21:06:18Z INFO  nhs_rt_full]   Final temperature: 300.0K
[2026-02-04T21:06:18Z INFO  nhs_rt_full]   Intensity filter: kept 4400001 spikes (top 20%, threshold=0.79)
[2026-02-04T21:06:18Z INFO  nhs_rt_full] 
    [4/6] RT-accelerated spike clustering...
[2026-02-04T21:06:18Z INFO  prism_nhs::persistent_engine] ğŸ”· Initializing OptiX RT pipeline for clustering...
[2026-02-04T21:06:18Z INFO  prism_optix::loader] OptiX: Our function table size: 480 bytes
[2026-02-04T21:06:18Z INFO  prism_optix::loader] OptiX: ABI version 118 accepted our table size (480 bytes)
[2026-02-04T21:06:18Z INFO  prism_optix::loader] OptiX function table loaded successfully (ABI version 118, table_size=480 bytes)
[2026-02-04T21:06:18Z INFO  prism_optix::context_impl] OptiX API initialized (version 90100)
[2026-02-04T21:06:18Z INFO  prism_optix::context_impl] Created OptiX context (validation: false)
[2026-02-04T21:06:18Z INFO  prism_nhs::rt_clustering] RT clustering engine created
[2026-02-04T21:06:18Z INFO  prism_nhs::rt_clustering] Loading RT clustering pipeline from: crates/prism-gpu/src/kernels/rt_clustering.optixir
[2026-02-04T21:06:18Z INFO  prism_nhs::rt_clustering] RT clustering params struct size: 88 bytes
[2026-02-04T21:06:18Z INFO  prism_nhs::rt_clustering] Phase 2 (build neighbors) pipeline created
[2026-02-04T21:06:18Z INFO  prism_nhs::rt_clustering] Loading CUDA kernels from: crates/prism-gpu/src/kernels/rt_clustering_cuda.ptx
[2026-02-04T21:06:18Z INFO  prism_nhs::rt_clustering] CUDA union-find kernels loaded
[2026-02-04T21:06:18Z INFO  prism_nhs::rt_clustering] RT clustering pipeline loaded successfully
[2026-02-04T21:06:18Z INFO  prism_nhs::persistent_engine]   RT pipeline initialized: 54ms
[2026-02-04T21:06:18Z INFO  prism_nhs::persistent_engine]   GPU Architecture: Blackwell
[2026-02-04T21:06:18Z INFO  prism_optix::accel] Building BVH for 4400001 atoms using OptiX built-in spheres (allow_update=true, prefer_fast_trace=false)
[2026-02-04T21:06:18Z INFO  prism_optix::accel] âœ… BVH build complete: 4400001 spheres, handle=0x729cda00000c, size=381022976 bytes (363.37 MB)
[2026-02-04T21:10:32Z INFO  prism_nhs::rt_clustering] Phase 1 complete: 134664295 raw neighbor hits from 4400001 events
[2026-02-04T21:10:32Z INFO  prism_nhs::rt_clustering] Phase 2 complete: 134664295 total neighbor pairs
[2026-02-04T21:14:46Z INFO  prism_nhs::rt_clustering] Phase 3 complete: neighbor list built
[2026-02-04T21:14:46Z INFO  prism_nhs::rt_clustering] Phase 7 complete: cluster IDs assigned
[2026-02-04T21:14:46Z INFO  prism_nhs::rt_clustering] RT clustering: 4400001 events, 134664295 neighbors, 4354064 clusters, 508172.35ms
[2026-02-04T21:14:46Z INFO  nhs_rt_full]   âœ“ Clustering complete: 4354064 clusters, 134664295 neighbor pairs, 508172.35ms
[2026-02-04T21:14:49Z INFO  nhs_rt_full]   Binding sites: 2 (filtered from 4354064 clusters, min 50 spikes)
[2026-02-04T21:14:50Z INFO  nhs_rt_full] 
    [5/6] Aromatic proximity analysis...
[2026-02-04T21:14:50Z INFO  nhs_rt_full]   âœ“ Analyzed 2 sites, 0 druggable
[2026-02-04T21:14:50Z INFO  nhs_rt_full]     #1: ActiveSite at (22.1, 25.4, 22.1), quality=0.57, druggable=false
[2026-02-04T21:14:50Z INFO  nhs_rt_full]         Residues (30, 5 catalytic): A:ILE269, A:LEU228, A:HID300, A:HID299, A:ILE270, A:ILE268, A:HID30...
[2026-02-04T21:14:50Z INFO  nhs_rt_full]         Catalytic: A:LYS186 (4.9Ã…), A:GLU145 (6.3Ã…), A:LYS188 (6.5Ã…), A:LYS184 (7.9Ã…), A:SER33 (7.9Ã…)
[2026-02-04T21:14:50Z INFO  nhs_rt_full]     #2: ActiveSite at (62.5, -0.6, 19.0), quality=0.53, druggable=false
[2026-02-04T21:14:50Z INFO  nhs_rt_full]         Residues (25, 7 catalytic): B:ARG630, B:ARG631, B:GLN662, B:GLN661, B:GLN660, B:LYS591, B:ARG63...
[2026-02-04T21:14:50Z INFO  nhs_rt_full]         Catalytic: B:LYS591 (3.6Ã…), B:LYS592 (4.8Ã…), B:LYS590 (5.0Ã…), B:SER547 (5.8Ã…), B:LYS594 (6.4Ã…), B:LYS589 (6.7Ã…), B:SER549 (7.3Ã…)
[2026-02-04T21:14:50Z INFO  nhs_rt_full] 
    [6/6] Generating visualization output...
[2026-02-04T21:14:50Z INFO  prism_nhs::persistent_engine] Wrote binding sites PDB: e2e_fructose_aldolase/07_FructoseAldolase_apo.binding_sites.pdb
[2026-02-04T21:14:50Z INFO  prism_nhs::persistent_engine] Wrote PyMOL script: e2e_fructose_aldolase/07_FructoseAldolase_apo.binding_sites.pml
[2026-02-04T21:14:50Z INFO  prism_nhs::persistent_engine] Wrote ChimeraX script: e2e_fructose_aldolase/07_FructoseAldolase_apo.binding_sites.cxc
[2026-02-04T21:14:50Z INFO  prism_nhs::persistent_engine] Wrote Markdown report: e2e_fructose_aldolase/07_FructoseAldolase_apo.binding_sites.md
[2026-02-04T21:14:50Z INFO  nhs_rt_full]   âœ“ JSON summary: e2e_fructose_aldolase/07_FructoseAldolase_apo.binding_sites.json
[2026-02-04T21:14:50Z INFO  nhs_rt_full] 
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
[2026-02-04T21:14:50Z INFO  nhs_rt_full] â•‘  PIPELINE COMPLETE                                            â•‘
[2026-02-04T21:14:50Z INFO  nhs_rt_full] â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
[2026-02-04T21:14:50Z INFO  nhs_rt_full] â•‘  Structure: 07_FructoseAldolase_apo.topology                 â•‘
[2026-02-04T21:14:50Z INFO  nhs_rt_full] â•‘  Total time: 793.8                                         s â•‘
[2026-02-04T21:14:50Z INFO  nhs_rt_full] â•‘  Spikes detected: 4400001                                   â•‘
[2026-02-04T21:14:50Z INFO  nhs_rt_full] â•‘  Binding sites: 2                                           â•‘
[2026-02-04T21:14:50Z INFO  nhs_rt_full] â•‘  Druggable sites: 0                                         â•‘
[2026-02-04T21:14:50Z INFO  nhs_rt_full] â•‘  RT cores used: Yes                                         â•‘
[2026-02-04T21:14:50Z INFO  nhs_rt_full] â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
